import{S as pe,e as be,s as he,f as te,g as m,h as O,j as V,n as W,k as T,m as K,o as $,Q as X,w,r as ve,u as D,v as we,a5 as gr,a6 as _r,C as st,D as Zt,p as ie,b as Ot,Z as j,F as B,G as H,H as P,Y as Pe,af as G,M as me,I as ni,y as Kt,ap as qi,W as pr,ab as Be,aj as br,am as ai,K as si,q as vr,B as Gi,E as Fi,an as kt,ax as wr,a0 as ge,a2 as _e,N as yr,R as kr,T as Er,U as Dr,O as Mr,ad as Or,V as Tr,a1 as Cr}from"./index-32b3c32a.js";import{f as oi}from"./Button-cd96cb27.js";import{B as Rr}from"./BlockLabel-02a2f440.js";import{I as li}from"./Image-cf7b23ef.js";import{g as Ar}from"./utils-90f3612b.js";import{I as Fe}from"./IconButton-d32a99ea.js";import{C as Sr,M as Tt}from"./ModifyUpload-0734866e.js";import{C as Ir}from"./Copy-da46d326.js";import{U as Nr}from"./Undo-ae37ab68.js";import{U as zr}from"./Upload-7cfcfcb5.js";import{B as Lr}from"./Blocks-a882214d.js";import{U as Br}from"./UploadText-bc82dd10.js";function Hr(i){let e,t,r;return{c(){e=te("svg"),t=te("path"),r=te("path"),m(t,"d","M28.828 3.172a4.094 4.094 0 0 0-5.656 0L4.05 22.292A6.954 6.954 0 0 0 2 27.242V30h2.756a6.952 6.952 0 0 0 4.95-2.05L28.828 8.829a3.999 3.999 0 0 0 0-5.657zM10.91 18.26l2.829 2.829l-2.122 2.121l-2.828-2.828zm-2.619 8.276A4.966 4.966 0 0 1 4.756 28H4v-.759a4.967 4.967 0 0 1 1.464-3.535l1.91-1.91l2.829 2.828zM27.415 7.414l-12.261 12.26l-2.829-2.828l12.262-12.26a2.047 2.047 0 0 1 2.828 0a2 2 0 0 1 0 2.828z"),m(t,"fill","currentColor"),m(r,"d","M6.5 15a3.5 3.5 0 0 1-2.475-5.974l3.5-3.5a1.502 1.502 0 0 0 0-2.121a1.537 1.537 0 0 0-2.121 0L3.415 5.394L2 3.98l1.99-1.988a3.585 3.585 0 0 1 4.95 0a3.504 3.504 0 0 1 0 4.949L5.439 10.44a1.502 1.502 0 0 0 0 2.121a1.537 1.537 0 0 0 2.122 0l4.024-4.024L13 9.95l-4.025 4.024A3.475 3.475 0 0 1 6.5 15z"),m(r,"fill","currentColor"),m(e,"width","100%"),m(e,"height","100%"),m(e,"viewBox","0 0 32 32")},m(a,n){O(a,e,n),V(e,t),V(e,r)},p:W,i:W,o:W,d(a){a&&T(e)}}}class Pr extends pe{constructor(e){super(),be(this,e,null,Hr,he,{})}}function Wr(i){let e,t,r;return{c(){e=te("svg"),t=te("path"),r=te("circle"),m(t,"d","M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"),m(r,"cx","12"),m(r,"cy","13"),m(r,"r","4"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"width","100%"),m(e,"height","100%"),m(e,"viewBox","0 0 24 24"),m(e,"fill","none"),m(e,"stroke","currentColor"),m(e,"stroke-width","1.5"),m(e,"stroke-linecap","round"),m(e,"stroke-linejoin","round"),m(e,"class","feather feather-camera")},m(a,n){O(a,e,n),V(e,t),V(e,r)},p:W,i:W,o:W,d(a){a&&T(e)}}}class Yr extends pe{constructor(e){super(),be(this,e,null,Wr,he,{})}}function Xr(i){let e,t;return{c(){e=te("svg"),t=te("circle"),m(t,"cx","12"),m(t,"cy","12"),m(t,"r","10"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"width","100%"),m(e,"height","100%"),m(e,"viewBox","0 0 24 24"),m(e,"fill","red"),m(e,"stroke","red"),m(e,"stroke-width","1.5"),m(e,"stroke-linecap","round"),m(e,"stroke-linejoin","round"),m(e,"class","feather feather-circle")},m(r,a){O(r,e,a),V(e,t)},p:W,i:W,o:W,d(r){r&&T(e)}}}class Ur extends pe{constructor(e){super(),be(this,e,null,Xr,he,{})}}function jr(i){let e,t,r,a,n,s,l;return{c(){e=te("svg"),t=te("circle"),r=te("circle"),a=te("circle"),n=te("circle"),s=te("circle"),l=te("path"),m(t,"cx","10"),m(t,"cy","12"),m(t,"r","2"),m(t,"fill","currentColor"),m(r,"cx","16"),m(r,"cy","9"),m(r,"r","2"),m(r,"fill","currentColor"),m(a,"cx","22"),m(a,"cy","12"),m(a,"r","2"),m(a,"fill","currentColor"),m(n,"cx","23"),m(n,"cy","18"),m(n,"r","2"),m(n,"fill","currentColor"),m(s,"cx","19"),m(s,"cy","23"),m(s,"r","2"),m(s,"fill","currentColor"),m(l,"fill","currentColor"),m(l,"d","M16.54 2A14 14 0 0 0 2 16a4.82 4.82 0 0 0 6.09 4.65l1.12-.31a3 3 0 0 1 3.79 2.9V27a3 3 0 0 0 3 3a14 14 0 0 0 14-14.54A14.05 14.05 0 0 0 16.54 2Zm8.11 22.31A11.93 11.93 0 0 1 16 28a1 1 0 0 1-1-1v-3.76a5 5 0 0 0-5-5a5.07 5.07 0 0 0-1.33.18l-1.12.31A2.82 2.82 0 0 1 4 16A12 12 0 0 1 16.47 4A12.18 12.18 0 0 1 28 15.53a11.89 11.89 0 0 1-3.35 8.79Z"),m(e,"width","100%"),m(e,"height","100%"),m(e,"viewBox","0 0 32 32")},m(o,h){O(o,e,h),V(e,t),V(e,r),V(e,a),V(e,n),V(e,s),V(e,l)},p:W,i:W,o:W,d(o){o&&T(e)}}}class Vr extends pe{constructor(e){super(),be(this,e,null,jr,he,{})}}function qr(i){let e,t;return{c(){e=te("svg"),t=te("path"),m(t,"fill","currentColor"),m(t,"d","M7 27h23v2H7zm20.38-16.49l-7.93-7.92a2 2 0 0 0-2.83 0l-14 14a2 2 0 0 0 0 2.83L7.13 24h9.59l10.66-10.66a2 2 0 0 0 0-2.83zM15.89 22H8l-4-4l6.31-6.31l7.93 7.92zm3.76-3.76l-7.92-7.93L18 4l8 7.93z"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"width","100%"),m(e,"height","100%"),m(e,"viewBox","0 0 32 32")},m(r,a){O(r,e,a),V(e,t)},p:W,i:W,o:W,d(r){r&&T(e)}}}class Gr extends pe{constructor(e){super(),be(this,e,null,qr,he,{})}}function Fr(i){let e,t;return{c(){e=te("svg"),t=te("path"),m(t,"d","M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"width","100%"),m(e,"height","100%"),m(e,"viewBox","0 0 24 24"),m(e,"fill","none"),m(e,"stroke","currentColor"),m(e,"stroke-width","1.5"),m(e,"stroke-linecap","round"),m(e,"stroke-linejoin","round"),m(e,"class","feather feather-edit-2")},m(r,a){O(r,e,a),V(e,t)},p:W,i:W,o:W,d(r){r&&T(e)}}}let hi=class extends pe{constructor(e){super(),be(this,e,null,Fr,he,{})}};function Zr(i){let e,t;return{c(){e=te("svg"),t=te("rect"),m(t,"x","3"),m(t,"y","3"),m(t,"width","18"),m(t,"height","18"),m(t,"rx","2"),m(t,"ry","2"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"width","100%"),m(e,"height","100%"),m(e,"viewBox","0 0 24 24"),m(e,"fill","red"),m(e,"stroke","red"),m(e,"stroke-width","1.5"),m(e,"stroke-linecap","round"),m(e,"stroke-linejoin","round"),m(e,"class","feather feather-square")},m(r,a){O(r,e,a),V(e,t)},p:W,i:W,o:W,d(r){r&&T(e)}}}class Kr extends pe{constructor(e){super(),be(this,e,null,Zr,he,{})}}function ui(i){let e,t,r,a,n,s;const l=[Jr,Qr],o=[];function h(u,c){return u[1]==="video"?0:1}return t=h(i),r=o[t]=l[t](i),{c(){e=K("button"),r.c(),m(e,"class","svelte-425ent")},m(u,c){O(u,e,c),o[t].m(e,null),a=!0,n||(s=ie(e,"click",function(){Ot(i[1]==="image"?i[5]:i[6])&&(i[1]==="image"?i[5]:i[6]).apply(this,arguments)}),n=!0)},p(u,c){i=u;let f=t;t=h(i),t===f?o[t].p(i,c):(ve(),D(o[f],1,1,()=>{o[f]=null}),we(),r=o[t],r?r.p(i,c):(r=o[t]=l[t](i),r.c()),w(r,1),r.m(e,null))},i(u){a||(w(r),a=!0)},o(u){D(r),a=!1},d(u){u&&T(e),o[t].d(),n=!1,s()}}}function Qr(i){let e,t,r;return t=new Yr({}),{c(){e=K("div"),B(t.$$.fragment),m(e,"class","icon svelte-425ent")},m(a,n){O(a,e,n),H(t,e,null),r=!0},p:W,i(a){r||(w(t.$$.fragment,a),r=!0)},o(a){D(t.$$.fragment,a),r=!1},d(a){a&&T(e),P(t)}}}function Jr(i){let e,t,r,a;const n=[$r,xr],s=[];function l(o,h){return o[4]?0:1}return e=l(i),t=s[e]=n[e](i),{c(){t.c(),r=Pe()},m(o,h){s[e].m(o,h),O(o,r,h),a=!0},p(o,h){let u=e;e=l(o),e!==u&&(ve(),D(s[u],1,1,()=>{s[u]=null}),we(),t=s[e],t||(t=s[e]=n[e](o),t.c()),w(t,1),t.m(r.parentNode,r))},i(o){a||(w(t),a=!0)},o(o){D(t),a=!1},d(o){o&&T(r),s[e].d(o)}}}function xr(i){let e,t,r;return t=new Ur({}),{c(){e=K("div"),B(t.$$.fragment),m(e,"class","icon svelte-425ent")},m(a,n){O(a,e,n),H(t,e,null),r=!0},i(a){r||(w(t.$$.fragment,a),r=!0)},o(a){D(t.$$.fragment,a),r=!1},d(a){a&&T(e),P(t)}}}function $r(i){let e,t,r;return t=new Kr({}),{c(){e=K("div"),B(t.$$.fragment),m(e,"class","icon svelte-425ent")},m(a,n){O(a,e,n),H(t,e,null),r=!0},i(a){r||(w(t.$$.fragment,a),r=!0)},o(a){D(t.$$.fragment,a),r=!1},d(a){a&&T(e),P(t)}}}function en(i){let e,t,r,a,n=!i[0]&&ui(i);return{c(){e=K("div"),t=K("video"),r=$(),n&&n.c(),m(t,"class","svelte-425ent"),X(t,"flip",i[2]),m(e,"class","wrap svelte-425ent")},m(s,l){O(s,e,l),V(e,t),i[9](t),V(e,r),n&&n.m(e,null),a=!0},p(s,[l]){(!a||l&4)&&X(t,"flip",s[2]),s[0]?n&&(ve(),D(n,1,1,()=>{n=null}),we()):n?(n.p(s,l),l&1&&w(n,1)):(n=ui(s),n.c(),w(n,1),n.m(e,null))},i(s){a||(w(n),a=!0)},o(s){D(n),a=!1},d(s){s&&T(e),i[9](null),n&&n.d()}}}function tn(i,e,t){let r;gr(i,_r,y=>t(15,r=y));let a,n,{streaming:s=!1}=e,{pending:l=!1}=e,{mode:o="image"}=e,{mirror_webcam:h}=e,{include_audio:u}=e;const c=st();Zt(()=>n=document.createElement("canvas"));async function f(){try{E=await navigator.mediaDevices.getUserMedia({video:!0,audio:u}),t(3,a.srcObject=E,a),t(3,a.muted=!0,a),a.play()}catch(y){if(y instanceof DOMException&&y.name=="NotAllowedError")c("error",r("image.allow_webcam_access"));else throw y}}function d(){var y=n.getContext("2d");if(a.videoWidth&&a.videoHeight){n.width=a.videoWidth,n.height=a.videoHeight,y.drawImage(a,0,0,a.videoWidth,a.videoHeight);var g=n.toDataURL("image/png");c(s?"stream":"capture",g)}}let _=!1,v=[],E,N,C;function A(){if(_){C.stop();let y=new Blob(v,{type:N}),g=new FileReader;g.onload=function(M){M.target&&(c("capture",{data:M.target.result,name:"sample."+N.substring(6),is_example:!1}),c("stop_recording"))},g.readAsDataURL(y)}else{c("start_recording"),v=[];let y=["video/webm","video/mp4"];for(let g of y)if(MediaRecorder.isTypeSupported(g)){N=g;break}if(N===null){console.error("No supported MediaRecorder mimeType");return}C=new MediaRecorder(E,{mimeType:N}),C.addEventListener("dataavailable",function(g){v.push(g.data)}),C.start(200)}t(4,_=!_)}f(),s&&o==="image"&&window.setInterval(()=>{a&&!l&&d()},500);function ee(y){j[y?"unshift":"push"](()=>{a=y,t(3,a)})}return i.$$set=y=>{"streaming"in y&&t(0,s=y.streaming),"pending"in y&&t(7,l=y.pending),"mode"in y&&t(1,o=y.mode),"mirror_webcam"in y&&t(2,h=y.mirror_webcam),"include_audio"in y&&t(8,u=y.include_audio)},[s,o,h,a,_,d,A,l,u,ee]}class rn extends pe{constructor(e){super(),be(this,e,tn,en,he,{streaming:0,pending:7,mode:1,mirror_webcam:2,include_audio:8})}}const nn=rn;/*!
 * Cropper.js v1.5.12
 * https://fengyuanchen.github.io/cropperjs
 *
 * Copyright 2015-present Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2021-06-12T08:00:17.411Z
 */function ci(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(i);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(i,a).enumerable})),t.push.apply(t,r)}return t}function Zi(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?ci(Object(t),!0).forEach(function(r){on(i,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):ci(Object(t)).forEach(function(r){Object.defineProperty(i,r,Object.getOwnPropertyDescriptor(t,r))})}return i}function yt(i){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?yt=function(e){return typeof e}:yt=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yt(i)}function an(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}function fi(i,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(i,r.key,r)}}function sn(i,e,t){return e&&fi(i.prototype,e),t&&fi(i,t),i}function on(i,e,t){return e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Ki(i){return ln(i)||hn(i)||un(i)||cn()}function ln(i){if(Array.isArray(i))return Pt(i)}function hn(i){if(typeof Symbol<"u"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function un(i,e){if(i){if(typeof i=="string")return Pt(i,e);var t=Object.prototype.toString.call(i).slice(8,-1);if(t==="Object"&&i.constructor&&(t=i.constructor.name),t==="Map"||t==="Set")return Array.from(i);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Pt(i,e)}}function Pt(i,e){(e==null||e>i.length)&&(e=i.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=i[t];return r}function cn(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Ct=typeof window<"u"&&typeof window.document<"u",Oe=Ct?window:{},Qt=Ct&&Oe.document.documentElement?"ontouchstart"in Oe.document.documentElement:!1,Jt=Ct?"PointerEvent"in Oe:!1,F="cropper",xt="all",Qi="crop",Ji="move",xi="zoom",ze="e",Le="w",Ve="s",Ae="n",$e="ne",et="nw",tt="se",it="sw",Wt="".concat(F,"-crop"),di="".concat(F,"-disabled"),de="".concat(F,"-hidden"),mi="".concat(F,"-hide"),fn="".concat(F,"-invisible"),Et="".concat(F,"-modal"),Yt="".concat(F,"-move"),nt="".concat(F,"Action"),vt="".concat(F,"Preview"),$t="crop",$i="move",er="none",Xt="crop",Ut="cropend",jt="cropmove",Vt="cropstart",gi="dblclick",dn=Qt?"touchstart":"mousedown",mn=Qt?"touchmove":"mousemove",gn=Qt?"touchend touchcancel":"mouseup",_i=Jt?"pointerdown":dn,pi=Jt?"pointermove":mn,bi=Jt?"pointerup pointercancel":gn,vi="ready",wi="resize",yi="wheel",qt="zoom",ki="image/jpeg",_n=/^e|w|s|n|se|sw|ne|nw|all|crop|move|zoom$/,pn=/^data:/,bn=/^data:image\/jpeg;base64,/,vn=/^img|canvas$/i,tr=200,ir=100,Ei={viewMode:0,dragMode:$t,initialAspectRatio:NaN,aspectRatio:NaN,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:tr,minContainerHeight:ir,ready:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},wn='<div class="cropper-container" touch-action="none"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-cropper-action="e"></span><span class="cropper-line line-n" data-cropper-action="n"></span><span class="cropper-line line-w" data-cropper-action="w"></span><span class="cropper-line line-s" data-cropper-action="s"></span><span class="cropper-point point-e" data-cropper-action="e"></span><span class="cropper-point point-n" data-cropper-action="n"></span><span class="cropper-point point-w" data-cropper-action="w"></span><span class="cropper-point point-s" data-cropper-action="s"></span><span class="cropper-point point-ne" data-cropper-action="ne"></span><span class="cropper-point point-nw" data-cropper-action="nw"></span><span class="cropper-point point-sw" data-cropper-action="sw"></span><span class="cropper-point point-se" data-cropper-action="se"></span></div></div>',yn=Number.isNaN||Oe.isNaN;function I(i){return typeof i=="number"&&!yn(i)}var Di=function(e){return e>0&&e<1/0};function Bt(i){return typeof i>"u"}function He(i){return yt(i)==="object"&&i!==null}var kn=Object.prototype.hasOwnProperty;function qe(i){if(!He(i))return!1;try{var e=i.constructor,t=e.prototype;return e&&t&&kn.call(t,"isPrototypeOf")}catch{return!1}}function fe(i){return typeof i=="function"}var En=Array.prototype.slice;function rr(i){return Array.from?Array.from(i):En.call(i)}function re(i,e){return i&&fe(e)&&(Array.isArray(i)||I(i.length)?rr(i).forEach(function(t,r){e.call(i,t,r,i)}):He(i)&&Object.keys(i).forEach(function(t){e.call(i,i[t],t,i)})),i}var Z=Object.assign||function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];return He(e)&&r.length>0&&r.forEach(function(n){He(n)&&Object.keys(n).forEach(function(s){e[s]=n[s]})}),e},Dn=/\.\d*(?:0|9){12}\d*$/;function Ze(i){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e11;return Dn.test(i)?Math.round(i*e)/e:i}var Mn=/^width|height|left|top|marginLeft|marginTop$/;function Se(i,e){var t=i.style;re(e,function(r,a){Mn.test(a)&&I(r)&&(r="".concat(r,"px")),t[a]=r})}function On(i,e){return i.classList?i.classList.contains(e):i.className.indexOf(e)>-1}function ae(i,e){if(e){if(I(i.length)){re(i,function(r){ae(r,e)});return}if(i.classList){i.classList.add(e);return}var t=i.className.trim();t?t.indexOf(e)<0&&(i.className="".concat(t," ").concat(e)):i.className=e}}function Me(i,e){if(e){if(I(i.length)){re(i,function(t){Me(t,e)});return}if(i.classList){i.classList.remove(e);return}i.className.indexOf(e)>=0&&(i.className=i.className.replace(e,""))}}function Ge(i,e,t){if(e){if(I(i.length)){re(i,function(r){Ge(r,e,t)});return}t?ae(i,e):Me(i,e)}}var Tn=/([a-z\d])([A-Z])/g;function ei(i){return i.replace(Tn,"$1-$2").toLowerCase()}function Gt(i,e){return He(i[e])?i[e]:i.dataset?i.dataset[e]:i.getAttribute("data-".concat(ei(e)))}function at(i,e,t){He(t)?i[e]=t:i.dataset?i.dataset[e]=t:i.setAttribute("data-".concat(ei(e)),t)}function Cn(i,e){if(He(i[e]))try{delete i[e]}catch{i[e]=void 0}else if(i.dataset)try{delete i.dataset[e]}catch{i.dataset[e]=void 0}else i.removeAttribute("data-".concat(ei(e)))}var nr=/\s\s*/,ar=function(){var i=!1;if(Ct){var e=!1,t=function(){},r=Object.defineProperty({},"once",{get:function(){return i=!0,e},set:function(n){e=n}});Oe.addEventListener("test",t,r),Oe.removeEventListener("test",t,r)}return i}();function De(i,e,t){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},a=t;e.trim().split(nr).forEach(function(n){if(!ar){var s=i.listeners;s&&s[n]&&s[n][t]&&(a=s[n][t],delete s[n][t],Object.keys(s[n]).length===0&&delete s[n],Object.keys(s).length===0&&delete i.listeners)}i.removeEventListener(n,a,r)})}function ke(i,e,t){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},a=t;e.trim().split(nr).forEach(function(n){if(r.once&&!ar){var s=i.listeners,l=s===void 0?{}:s;a=function(){delete l[n][t],i.removeEventListener(n,a,r);for(var h=arguments.length,u=new Array(h),c=0;c<h;c++)u[c]=arguments[c];t.apply(i,u)},l[n]||(l[n]={}),l[n][t]&&i.removeEventListener(n,l[n][t],r),l[n][t]=a,i.listeners=l}i.addEventListener(n,a,r)})}function Ke(i,e,t){var r;return fe(Event)&&fe(CustomEvent)?r=new CustomEvent(e,{detail:t,bubbles:!0,cancelable:!0}):(r=document.createEvent("CustomEvent"),r.initCustomEvent(e,!0,!0,t)),i.dispatchEvent(r)}function sr(i){var e=i.getBoundingClientRect();return{left:e.left+(window.pageXOffset-document.documentElement.clientLeft),top:e.top+(window.pageYOffset-document.documentElement.clientTop)}}var Ht=Oe.location,Rn=/^(\w+:)\/\/([^:/?#]*):?(\d*)/i;function Mi(i){var e=i.match(Rn);return e!==null&&(e[1]!==Ht.protocol||e[2]!==Ht.hostname||e[3]!==Ht.port)}function Oi(i){var e="timestamp=".concat(new Date().getTime());return i+(i.indexOf("?")===-1?"?":"&")+e}function rt(i){var e=i.rotate,t=i.scaleX,r=i.scaleY,a=i.translateX,n=i.translateY,s=[];I(a)&&a!==0&&s.push("translateX(".concat(a,"px)")),I(n)&&n!==0&&s.push("translateY(".concat(n,"px)")),I(e)&&e!==0&&s.push("rotate(".concat(e,"deg)")),I(t)&&t!==1&&s.push("scaleX(".concat(t,")")),I(r)&&r!==1&&s.push("scaleY(".concat(r,")"));var l=s.length?s.join(" "):"none";return{WebkitTransform:l,msTransform:l,transform:l}}function An(i){var e=Zi({},i),t=0;return re(i,function(r,a){delete e[a],re(e,function(n){var s=Math.abs(r.startX-n.startX),l=Math.abs(r.startY-n.startY),o=Math.abs(r.endX-n.endX),h=Math.abs(r.endY-n.endY),u=Math.sqrt(s*s+l*l),c=Math.sqrt(o*o+h*h),f=(c-u)/u;Math.abs(f)>Math.abs(t)&&(t=f)})}),t}function wt(i,e){var t=i.pageX,r=i.pageY,a={endX:t,endY:r};return e?a:Zi({startX:t,startY:r},a)}function Sn(i){var e=0,t=0,r=0;return re(i,function(a){var n=a.startX,s=a.startY;e+=n,t+=s,r+=1}),e/=r,t/=r,{pageX:e,pageY:t}}function Ie(i){var e=i.aspectRatio,t=i.height,r=i.width,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"contain",n=Di(r),s=Di(t);if(n&&s){var l=t*e;a==="contain"&&l>r||a==="cover"&&l<r?t=r/e:r=t*e}else n?t=r/e:s&&(r=t*e);return{width:r,height:t}}function In(i){var e=i.width,t=i.height,r=i.degree;if(r=Math.abs(r)%180,r===90)return{width:t,height:e};var a=r%90*Math.PI/180,n=Math.sin(a),s=Math.cos(a),l=e*s+t*n,o=e*n+t*s;return r>90?{width:o,height:l}:{width:l,height:o}}function Nn(i,e,t,r){var a=e.aspectRatio,n=e.naturalWidth,s=e.naturalHeight,l=e.rotate,o=l===void 0?0:l,h=e.scaleX,u=h===void 0?1:h,c=e.scaleY,f=c===void 0?1:c,d=t.aspectRatio,_=t.naturalWidth,v=t.naturalHeight,E=r.fillColor,N=E===void 0?"transparent":E,C=r.imageSmoothingEnabled,A=C===void 0?!0:C,ee=r.imageSmoothingQuality,y=ee===void 0?"low":ee,g=r.maxWidth,M=g===void 0?1/0:g,S=r.maxHeight,z=S===void 0?1/0:S,x=r.minWidth,se=x===void 0?0:x,le=r.minHeight,Y=le===void 0?0:le,Q=document.createElement("canvas"),J=Q.getContext("2d"),oe=Ie({aspectRatio:d,width:M,height:z}),U=Ie({aspectRatio:d,width:se,height:Y},"cover"),ue=Math.min(oe.width,Math.max(U.width,_)),ye=Math.min(oe.height,Math.max(U.height,v)),k=Ie({aspectRatio:a,width:M,height:z}),Ee=Ie({aspectRatio:a,width:se,height:Y},"cover"),Ce=Math.min(k.width,Math.max(Ee.width,n)),We=Math.min(k.height,Math.max(Ee.height,s)),Ye=[-Ce/2,-We/2,Ce,We];return Q.width=Ze(ue),Q.height=Ze(ye),J.fillStyle=N,J.fillRect(0,0,ue,ye),J.save(),J.translate(ue/2,ye/2),J.rotate(o*Math.PI/180),J.scale(u,f),J.imageSmoothingEnabled=A,J.imageSmoothingQuality=y,J.drawImage.apply(J,[i].concat(Ki(Ye.map(function(Je){return Math.floor(Ze(Je))})))),J.restore(),Q}var or=String.fromCharCode;function zn(i,e,t){var r="";t+=e;for(var a=e;a<t;a+=1)r+=or(i.getUint8(a));return r}var Ln=/^data:.*,/;function Bn(i){var e=i.replace(Ln,""),t=atob(e),r=new ArrayBuffer(t.length),a=new Uint8Array(r);return re(a,function(n,s){a[s]=t.charCodeAt(s)}),r}function Hn(i,e){for(var t=[],r=8192,a=new Uint8Array(i);a.length>0;)t.push(or.apply(null,rr(a.subarray(0,r)))),a=a.subarray(r);return"data:".concat(e,";base64,").concat(btoa(t.join("")))}function Pn(i){var e=new DataView(i),t;try{var r,a,n;if(e.getUint8(0)===255&&e.getUint8(1)===216)for(var s=e.byteLength,l=2;l+1<s;){if(e.getUint8(l)===255&&e.getUint8(l+1)===225){a=l;break}l+=1}if(a){var o=a+4,h=a+10;if(zn(e,o,4)==="Exif"){var u=e.getUint16(h);if(r=u===18761,(r||u===19789)&&e.getUint16(h+2,r)===42){var c=e.getUint32(h+4,r);c>=8&&(n=h+c)}}}if(n){var f=e.getUint16(n,r),d,_;for(_=0;_<f;_+=1)if(d=n+_*12+2,e.getUint16(d,r)===274){d+=8,t=e.getUint16(d,r),e.setUint16(d,1,r);break}}}catch{t=1}return t}function Wn(i){var e=0,t=1,r=1;switch(i){case 2:t=-1;break;case 3:e=-180;break;case 4:r=-1;break;case 5:e=90,r=-1;break;case 6:e=90;break;case 7:e=90,t=-1;break;case 8:e=-90;break}return{rotate:e,scaleX:t,scaleY:r}}var Yn={render:function(){this.initContainer(),this.initCanvas(),this.initCropBox(),this.renderCanvas(),this.cropped&&this.renderCropBox()},initContainer:function(){var e=this.element,t=this.options,r=this.container,a=this.cropper,n=Number(t.minContainerWidth),s=Number(t.minContainerHeight);ae(a,de),Me(e,de);var l={width:Math.max(r.offsetWidth,n>=0?n:tr),height:Math.max(r.offsetHeight,s>=0?s:ir)};this.containerData=l,Se(a,{width:l.width,height:l.height}),ae(e,de),Me(a,de)},initCanvas:function(){var e=this.containerData,t=this.imageData,r=this.options.viewMode,a=Math.abs(t.rotate)%180===90,n=a?t.naturalHeight:t.naturalWidth,s=a?t.naturalWidth:t.naturalHeight,l=n/s,o=e.width,h=e.height;e.height*l>e.width?r===3?o=e.height*l:h=e.width/l:r===3?h=e.width/l:o=e.height*l;var u={aspectRatio:l,naturalWidth:n,naturalHeight:s,width:o,height:h};this.canvasData=u,this.limited=r===1||r===2,this.limitCanvas(!0,!0),u.width=Math.min(Math.max(u.width,u.minWidth),u.maxWidth),u.height=Math.min(Math.max(u.height,u.minHeight),u.maxHeight),u.left=(e.width-u.width)/2,u.top=(e.height-u.height)/2,u.oldLeft=u.left,u.oldTop=u.top,this.initialCanvasData=Z({},u)},limitCanvas:function(e,t){var r=this.options,a=this.containerData,n=this.canvasData,s=this.cropBoxData,l=r.viewMode,o=n.aspectRatio,h=this.cropped&&s;if(e){var u=Number(r.minCanvasWidth)||0,c=Number(r.minCanvasHeight)||0;l>1?(u=Math.max(u,a.width),c=Math.max(c,a.height),l===3&&(c*o>u?u=c*o:c=u/o)):l>0&&(u?u=Math.max(u,h?s.width:0):c?c=Math.max(c,h?s.height:0):h&&(u=s.width,c=s.height,c*o>u?u=c*o:c=u/o));var f=Ie({aspectRatio:o,width:u,height:c});u=f.width,c=f.height,n.minWidth=u,n.minHeight=c,n.maxWidth=1/0,n.maxHeight=1/0}if(t)if(l>(h?0:1)){var d=a.width-n.width,_=a.height-n.height;n.minLeft=Math.min(0,d),n.minTop=Math.min(0,_),n.maxLeft=Math.max(0,d),n.maxTop=Math.max(0,_),h&&this.limited&&(n.minLeft=Math.min(s.left,s.left+(s.width-n.width)),n.minTop=Math.min(s.top,s.top+(s.height-n.height)),n.maxLeft=s.left,n.maxTop=s.top,l===2&&(n.width>=a.width&&(n.minLeft=Math.min(0,d),n.maxLeft=Math.max(0,d)),n.height>=a.height&&(n.minTop=Math.min(0,_),n.maxTop=Math.max(0,_))))}else n.minLeft=-n.width,n.minTop=-n.height,n.maxLeft=a.width,n.maxTop=a.height},renderCanvas:function(e,t){var r=this.canvasData,a=this.imageData;if(t){var n=In({width:a.naturalWidth*Math.abs(a.scaleX||1),height:a.naturalHeight*Math.abs(a.scaleY||1),degree:a.rotate||0}),s=n.width,l=n.height,o=r.width*(s/r.naturalWidth),h=r.height*(l/r.naturalHeight);r.left-=(o-r.width)/2,r.top-=(h-r.height)/2,r.width=o,r.height=h,r.aspectRatio=s/l,r.naturalWidth=s,r.naturalHeight=l,this.limitCanvas(!0,!1)}(r.width>r.maxWidth||r.width<r.minWidth)&&(r.left=r.oldLeft),(r.height>r.maxHeight||r.height<r.minHeight)&&(r.top=r.oldTop),r.width=Math.min(Math.max(r.width,r.minWidth),r.maxWidth),r.height=Math.min(Math.max(r.height,r.minHeight),r.maxHeight),this.limitCanvas(!1,!0),r.left=Math.min(Math.max(r.left,r.minLeft),r.maxLeft),r.top=Math.min(Math.max(r.top,r.minTop),r.maxTop),r.oldLeft=r.left,r.oldTop=r.top,Se(this.canvas,Z({width:r.width,height:r.height},rt({translateX:r.left,translateY:r.top}))),this.renderImage(e),this.cropped&&this.limited&&this.limitCropBox(!0,!0)},renderImage:function(e){var t=this.canvasData,r=this.imageData,a=r.naturalWidth*(t.width/t.naturalWidth),n=r.naturalHeight*(t.height/t.naturalHeight);Z(r,{width:a,height:n,left:(t.width-a)/2,top:(t.height-n)/2}),Se(this.image,Z({width:r.width,height:r.height},rt(Z({translateX:r.left,translateY:r.top},r)))),e&&this.output()},initCropBox:function(){var e=this.options,t=this.canvasData,r=e.aspectRatio||e.initialAspectRatio,a=Number(e.autoCropArea)||.8,n={width:t.width,height:t.height};r&&(t.height*r>t.width?n.height=n.width/r:n.width=n.height*r),this.cropBoxData=n,this.limitCropBox(!0,!0),n.width=Math.min(Math.max(n.width,n.minWidth),n.maxWidth),n.height=Math.min(Math.max(n.height,n.minHeight),n.maxHeight),n.width=Math.max(n.minWidth,n.width*a),n.height=Math.max(n.minHeight,n.height*a),n.left=t.left+(t.width-n.width)/2,n.top=t.top+(t.height-n.height)/2,n.oldLeft=n.left,n.oldTop=n.top,this.initialCropBoxData=Z({},n)},limitCropBox:function(e,t){var r=this.options,a=this.containerData,n=this.canvasData,s=this.cropBoxData,l=this.limited,o=r.aspectRatio;if(e){var h=Number(r.minCropBoxWidth)||0,u=Number(r.minCropBoxHeight)||0,c=l?Math.min(a.width,n.width,n.width+n.left,a.width-n.left):a.width,f=l?Math.min(a.height,n.height,n.height+n.top,a.height-n.top):a.height;h=Math.min(h,a.width),u=Math.min(u,a.height),o&&(h&&u?u*o>h?u=h/o:h=u*o:h?u=h/o:u&&(h=u*o),f*o>c?f=c/o:c=f*o),s.minWidth=Math.min(h,c),s.minHeight=Math.min(u,f),s.maxWidth=c,s.maxHeight=f}t&&(l?(s.minLeft=Math.max(0,n.left),s.minTop=Math.max(0,n.top),s.maxLeft=Math.min(a.width,n.left+n.width)-s.width,s.maxTop=Math.min(a.height,n.top+n.height)-s.height):(s.minLeft=0,s.minTop=0,s.maxLeft=a.width-s.width,s.maxTop=a.height-s.height))},renderCropBox:function(){var e=this.options,t=this.containerData,r=this.cropBoxData;(r.width>r.maxWidth||r.width<r.minWidth)&&(r.left=r.oldLeft),(r.height>r.maxHeight||r.height<r.minHeight)&&(r.top=r.oldTop),r.width=Math.min(Math.max(r.width,r.minWidth),r.maxWidth),r.height=Math.min(Math.max(r.height,r.minHeight),r.maxHeight),this.limitCropBox(!1,!0),r.left=Math.min(Math.max(r.left,r.minLeft),r.maxLeft),r.top=Math.min(Math.max(r.top,r.minTop),r.maxTop),r.oldLeft=r.left,r.oldTop=r.top,e.movable&&e.cropBoxMovable&&at(this.face,nt,r.width>=t.width&&r.height>=t.height?Ji:xt),Se(this.cropBox,Z({width:r.width,height:r.height},rt({translateX:r.left,translateY:r.top}))),this.cropped&&this.limited&&this.limitCanvas(!0,!0),this.disabled||this.output()},output:function(){this.preview(),Ke(this.element,Xt,this.getData())}},Xn={initPreview:function(){var e=this.element,t=this.crossOrigin,r=this.options.preview,a=t?this.crossOriginUrl:this.url,n=e.alt||"The image to preview",s=document.createElement("img");if(t&&(s.crossOrigin=t),s.src=a,s.alt=n,this.viewBox.appendChild(s),this.viewBoxImage=s,!!r){var l=r;typeof r=="string"?l=e.ownerDocument.querySelectorAll(r):r.querySelector&&(l=[r]),this.previews=l,re(l,function(o){var h=document.createElement("img");at(o,vt,{width:o.offsetWidth,height:o.offsetHeight,html:o.innerHTML}),t&&(h.crossOrigin=t),h.src=a,h.alt=n,h.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"',o.innerHTML="",o.appendChild(h)})}},resetPreview:function(){re(this.previews,function(e){var t=Gt(e,vt);Se(e,{width:t.width,height:t.height}),e.innerHTML=t.html,Cn(e,vt)})},preview:function(){var e=this.imageData,t=this.canvasData,r=this.cropBoxData,a=r.width,n=r.height,s=e.width,l=e.height,o=r.left-t.left-e.left,h=r.top-t.top-e.top;!this.cropped||this.disabled||(Se(this.viewBoxImage,Z({width:s,height:l},rt(Z({translateX:-o,translateY:-h},e)))),re(this.previews,function(u){var c=Gt(u,vt),f=c.width,d=c.height,_=f,v=d,E=1;a&&(E=f/a,v=n*E),n&&v>d&&(E=d/n,_=a*E,v=d),Se(u,{width:_,height:v}),Se(u.getElementsByTagName("img")[0],Z({width:s*E,height:l*E},rt(Z({translateX:-o*E,translateY:-h*E},e))))}))}},Un={bind:function(){var e=this.element,t=this.options,r=this.cropper;fe(t.cropstart)&&ke(e,Vt,t.cropstart),fe(t.cropmove)&&ke(e,jt,t.cropmove),fe(t.cropend)&&ke(e,Ut,t.cropend),fe(t.crop)&&ke(e,Xt,t.crop),fe(t.zoom)&&ke(e,qt,t.zoom),ke(r,_i,this.onCropStart=this.cropStart.bind(this)),t.zoomable&&t.zoomOnWheel&&ke(r,yi,this.onWheel=this.wheel.bind(this),{passive:!1,capture:!0}),t.toggleDragModeOnDblclick&&ke(r,gi,this.onDblclick=this.dblclick.bind(this)),ke(e.ownerDocument,pi,this.onCropMove=this.cropMove.bind(this)),ke(e.ownerDocument,bi,this.onCropEnd=this.cropEnd.bind(this)),t.responsive&&ke(window,wi,this.onResize=this.resize.bind(this))},unbind:function(){var e=this.element,t=this.options,r=this.cropper;fe(t.cropstart)&&De(e,Vt,t.cropstart),fe(t.cropmove)&&De(e,jt,t.cropmove),fe(t.cropend)&&De(e,Ut,t.cropend),fe(t.crop)&&De(e,Xt,t.crop),fe(t.zoom)&&De(e,qt,t.zoom),De(r,_i,this.onCropStart),t.zoomable&&t.zoomOnWheel&&De(r,yi,this.onWheel,{passive:!1,capture:!0}),t.toggleDragModeOnDblclick&&De(r,gi,this.onDblclick),De(e.ownerDocument,pi,this.onCropMove),De(e.ownerDocument,bi,this.onCropEnd),t.responsive&&De(window,wi,this.onResize)}},jn={resize:function(){if(!this.disabled){var e=this.options,t=this.container,r=this.containerData,a=t.offsetWidth/r.width,n=t.offsetHeight/r.height,s=Math.abs(a-1)>Math.abs(n-1)?a:n;if(s!==1){var l,o;e.restore&&(l=this.getCanvasData(),o=this.getCropBoxData()),this.render(),e.restore&&(this.setCanvasData(re(l,function(h,u){l[u]=h*s})),this.setCropBoxData(re(o,function(h,u){o[u]=h*s})))}}},dblclick:function(){this.disabled||this.options.dragMode===er||this.setDragMode(On(this.dragBox,Wt)?$i:$t)},wheel:function(e){var t=this,r=Number(this.options.wheelZoomRatio)||.1,a=1;this.disabled||(e.preventDefault(),!this.wheeling&&(this.wheeling=!0,setTimeout(function(){t.wheeling=!1},50),e.deltaY?a=e.deltaY>0?1:-1:e.wheelDelta?a=-e.wheelDelta/120:e.detail&&(a=e.detail>0?1:-1),this.zoom(-a*r,e)))},cropStart:function(e){var t=e.buttons,r=e.button;if(!(this.disabled||(e.type==="mousedown"||e.type==="pointerdown"&&e.pointerType==="mouse")&&(I(t)&&t!==1||I(r)&&r!==0||e.ctrlKey))){var a=this.options,n=this.pointers,s;e.changedTouches?re(e.changedTouches,function(l){n[l.identifier]=wt(l)}):n[e.pointerId||0]=wt(e),Object.keys(n).length>1&&a.zoomable&&a.zoomOnTouch?s=xi:s=Gt(e.target,nt),_n.test(s)&&Ke(this.element,Vt,{originalEvent:e,action:s})!==!1&&(e.preventDefault(),this.action=s,this.cropping=!1,s===Qi&&(this.cropping=!0,ae(this.dragBox,Et)))}},cropMove:function(e){var t=this.action;if(!(this.disabled||!t)){var r=this.pointers;e.preventDefault(),Ke(this.element,jt,{originalEvent:e,action:t})!==!1&&(e.changedTouches?re(e.changedTouches,function(a){Z(r[a.identifier]||{},wt(a,!0))}):Z(r[e.pointerId||0]||{},wt(e,!0)),this.change(e))}},cropEnd:function(e){if(!this.disabled){var t=this.action,r=this.pointers;e.changedTouches?re(e.changedTouches,function(a){delete r[a.identifier]}):delete r[e.pointerId||0],t&&(e.preventDefault(),Object.keys(r).length||(this.action=""),this.cropping&&(this.cropping=!1,Ge(this.dragBox,Et,this.cropped&&this.options.modal)),Ke(this.element,Ut,{originalEvent:e,action:t}))}}},Vn={change:function(e){var t=this.options,r=this.canvasData,a=this.containerData,n=this.cropBoxData,s=this.pointers,l=this.action,o=t.aspectRatio,h=n.left,u=n.top,c=n.width,f=n.height,d=h+c,_=u+f,v=0,E=0,N=a.width,C=a.height,A=!0,ee;!o&&e.shiftKey&&(o=c&&f?c/f:1),this.limited&&(v=n.minLeft,E=n.minTop,N=v+Math.min(a.width,r.width,r.left+r.width),C=E+Math.min(a.height,r.height,r.top+r.height));var y=s[Object.keys(s)[0]],g={x:y.endX-y.startX,y:y.endY-y.startY},M=function(z){switch(z){case ze:d+g.x>N&&(g.x=N-d);break;case Le:h+g.x<v&&(g.x=v-h);break;case Ae:u+g.y<E&&(g.y=E-u);break;case Ve:_+g.y>C&&(g.y=C-_);break}};switch(l){case xt:h+=g.x,u+=g.y;break;case ze:if(g.x>=0&&(d>=N||o&&(u<=E||_>=C))){A=!1;break}M(ze),c+=g.x,c<0&&(l=Le,c=-c,h-=c),o&&(f=c/o,u+=(n.height-f)/2);break;case Ae:if(g.y<=0&&(u<=E||o&&(h<=v||d>=N))){A=!1;break}M(Ae),f-=g.y,u+=g.y,f<0&&(l=Ve,f=-f,u-=f),o&&(c=f*o,h+=(n.width-c)/2);break;case Le:if(g.x<=0&&(h<=v||o&&(u<=E||_>=C))){A=!1;break}M(Le),c-=g.x,h+=g.x,c<0&&(l=ze,c=-c,h-=c),o&&(f=c/o,u+=(n.height-f)/2);break;case Ve:if(g.y>=0&&(_>=C||o&&(h<=v||d>=N))){A=!1;break}M(Ve),f+=g.y,f<0&&(l=Ae,f=-f,u-=f),o&&(c=f*o,h+=(n.width-c)/2);break;case $e:if(o){if(g.y<=0&&(u<=E||d>=N)){A=!1;break}M(Ae),f-=g.y,u+=g.y,c=f*o}else M(Ae),M(ze),g.x>=0?d<N?c+=g.x:g.y<=0&&u<=E&&(A=!1):c+=g.x,g.y<=0?u>E&&(f-=g.y,u+=g.y):(f-=g.y,u+=g.y);c<0&&f<0?(l=it,f=-f,c=-c,u-=f,h-=c):c<0?(l=et,c=-c,h-=c):f<0&&(l=tt,f=-f,u-=f);break;case et:if(o){if(g.y<=0&&(u<=E||h<=v)){A=!1;break}M(Ae),f-=g.y,u+=g.y,c=f*o,h+=n.width-c}else M(Ae),M(Le),g.x<=0?h>v?(c-=g.x,h+=g.x):g.y<=0&&u<=E&&(A=!1):(c-=g.x,h+=g.x),g.y<=0?u>E&&(f-=g.y,u+=g.y):(f-=g.y,u+=g.y);c<0&&f<0?(l=tt,f=-f,c=-c,u-=f,h-=c):c<0?(l=$e,c=-c,h-=c):f<0&&(l=it,f=-f,u-=f);break;case it:if(o){if(g.x<=0&&(h<=v||_>=C)){A=!1;break}M(Le),c-=g.x,h+=g.x,f=c/o}else M(Ve),M(Le),g.x<=0?h>v?(c-=g.x,h+=g.x):g.y>=0&&_>=C&&(A=!1):(c-=g.x,h+=g.x),g.y>=0?_<C&&(f+=g.y):f+=g.y;c<0&&f<0?(l=$e,f=-f,c=-c,u-=f,h-=c):c<0?(l=tt,c=-c,h-=c):f<0&&(l=et,f=-f,u-=f);break;case tt:if(o){if(g.x>=0&&(d>=N||_>=C)){A=!1;break}M(ze),c+=g.x,f=c/o}else M(Ve),M(ze),g.x>=0?d<N?c+=g.x:g.y>=0&&_>=C&&(A=!1):c+=g.x,g.y>=0?_<C&&(f+=g.y):f+=g.y;c<0&&f<0?(l=et,f=-f,c=-c,u-=f,h-=c):c<0?(l=it,c=-c,h-=c):f<0&&(l=$e,f=-f,u-=f);break;case Ji:this.move(g.x,g.y),A=!1;break;case xi:this.zoom(An(s),e),A=!1;break;case Qi:if(!g.x||!g.y){A=!1;break}ee=sr(this.cropper),h=y.startX-ee.left,u=y.startY-ee.top,c=n.minWidth,f=n.minHeight,g.x>0?l=g.y>0?tt:$e:g.x<0&&(h-=c,l=g.y>0?it:et),g.y<0&&(u-=f),this.cropped||(Me(this.cropBox,de),this.cropped=!0,this.limited&&this.limitCropBox(!0,!0));break}A&&(n.width=c,n.height=f,n.left=h,n.top=u,this.action=l,this.renderCropBox()),re(s,function(S){S.startX=S.endX,S.startY=S.endY})}},qn={crop:function(){return this.ready&&!this.cropped&&!this.disabled&&(this.cropped=!0,this.limitCropBox(!0,!0),this.options.modal&&ae(this.dragBox,Et),Me(this.cropBox,de),this.setCropBoxData(this.initialCropBoxData)),this},reset:function(){return this.ready&&!this.disabled&&(this.imageData=Z({},this.initialImageData),this.canvasData=Z({},this.initialCanvasData),this.cropBoxData=Z({},this.initialCropBoxData),this.renderCanvas(),this.cropped&&this.renderCropBox()),this},clear:function(){return this.cropped&&!this.disabled&&(Z(this.cropBoxData,{left:0,top:0,width:0,height:0}),this.cropped=!1,this.renderCropBox(),this.limitCanvas(!0,!0),this.renderCanvas(),Me(this.dragBox,Et),ae(this.cropBox,de)),this},replace:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return!this.disabled&&e&&(this.isImg&&(this.element.src=e),t?(this.url=e,this.image.src=e,this.ready&&(this.viewBoxImage.src=e,re(this.previews,function(r){r.getElementsByTagName("img")[0].src=e}))):(this.isImg&&(this.replaced=!0),this.options.data=null,this.uncreate(),this.load(e))),this},enable:function(){return this.ready&&this.disabled&&(this.disabled=!1,Me(this.cropper,di)),this},disable:function(){return this.ready&&!this.disabled&&(this.disabled=!0,ae(this.cropper,di)),this},destroy:function(){var e=this.element;return e[F]?(e[F]=void 0,this.isImg&&this.replaced&&(e.src=this.originalUrl),this.uncreate(),this):this},move:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=this.canvasData,a=r.left,n=r.top;return this.moveTo(Bt(e)?e:a+Number(e),Bt(t)?t:n+Number(t))},moveTo:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=this.canvasData,a=!1;return e=Number(e),t=Number(t),this.ready&&!this.disabled&&this.options.movable&&(I(e)&&(r.left=e,a=!0),I(t)&&(r.top=t,a=!0),a&&this.renderCanvas(!0)),this},zoom:function(e,t){var r=this.canvasData;return e=Number(e),e<0?e=1/(1-e):e=1+e,this.zoomTo(r.width*e/r.naturalWidth,null,t)},zoomTo:function(e,t,r){var a=this.options,n=this.canvasData,s=n.width,l=n.height,o=n.naturalWidth,h=n.naturalHeight;if(e=Number(e),e>=0&&this.ready&&!this.disabled&&a.zoomable){var u=o*e,c=h*e;if(Ke(this.element,qt,{ratio:e,oldRatio:s/o,originalEvent:r})===!1)return this;if(r){var f=this.pointers,d=sr(this.cropper),_=f&&Object.keys(f).length?Sn(f):{pageX:r.pageX,pageY:r.pageY};n.left-=(u-s)*((_.pageX-d.left-n.left)/s),n.top-=(c-l)*((_.pageY-d.top-n.top)/l)}else qe(t)&&I(t.x)&&I(t.y)?(n.left-=(u-s)*((t.x-n.left)/s),n.top-=(c-l)*((t.y-n.top)/l)):(n.left-=(u-s)/2,n.top-=(c-l)/2);n.width=u,n.height=c,this.renderCanvas(!0)}return this},rotate:function(e){return this.rotateTo((this.imageData.rotate||0)+Number(e))},rotateTo:function(e){return e=Number(e),I(e)&&this.ready&&!this.disabled&&this.options.rotatable&&(this.imageData.rotate=e%360,this.renderCanvas(!0,!0)),this},scaleX:function(e){var t=this.imageData.scaleY;return this.scale(e,I(t)?t:1)},scaleY:function(e){var t=this.imageData.scaleX;return this.scale(I(t)?t:1,e)},scale:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=this.imageData,a=!1;return e=Number(e),t=Number(t),this.ready&&!this.disabled&&this.options.scalable&&(I(e)&&(r.scaleX=e,a=!0),I(t)&&(r.scaleY=t,a=!0),a&&this.renderCanvas(!0,!0)),this},getData:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=this.options,r=this.imageData,a=this.canvasData,n=this.cropBoxData,s;if(this.ready&&this.cropped){s={x:n.left-a.left,y:n.top-a.top,width:n.width,height:n.height};var l=r.width/r.naturalWidth;if(re(s,function(u,c){s[c]=u/l}),e){var o=Math.round(s.y+s.height),h=Math.round(s.x+s.width);s.x=Math.round(s.x),s.y=Math.round(s.y),s.width=h-s.x,s.height=o-s.y}}else s={x:0,y:0,width:0,height:0};return t.rotatable&&(s.rotate=r.rotate||0),t.scalable&&(s.scaleX=r.scaleX||1,s.scaleY=r.scaleY||1),s},setData:function(e){var t=this.options,r=this.imageData,a=this.canvasData,n={};if(this.ready&&!this.disabled&&qe(e)){var s=!1;t.rotatable&&I(e.rotate)&&e.rotate!==r.rotate&&(r.rotate=e.rotate,s=!0),t.scalable&&(I(e.scaleX)&&e.scaleX!==r.scaleX&&(r.scaleX=e.scaleX,s=!0),I(e.scaleY)&&e.scaleY!==r.scaleY&&(r.scaleY=e.scaleY,s=!0)),s&&this.renderCanvas(!0,!0);var l=r.width/r.naturalWidth;I(e.x)&&(n.left=e.x*l+a.left),I(e.y)&&(n.top=e.y*l+a.top),I(e.width)&&(n.width=e.width*l),I(e.height)&&(n.height=e.height*l),this.setCropBoxData(n)}return this},getContainerData:function(){return this.ready?Z({},this.containerData):{}},getImageData:function(){return this.sized?Z({},this.imageData):{}},getCanvasData:function(){var e=this.canvasData,t={};return this.ready&&re(["left","top","width","height","naturalWidth","naturalHeight"],function(r){t[r]=e[r]}),t},setCanvasData:function(e){var t=this.canvasData,r=t.aspectRatio;return this.ready&&!this.disabled&&qe(e)&&(I(e.left)&&(t.left=e.left),I(e.top)&&(t.top=e.top),I(e.width)?(t.width=e.width,t.height=e.width/r):I(e.height)&&(t.height=e.height,t.width=e.height*r),this.renderCanvas(!0)),this},getCropBoxData:function(){var e=this.cropBoxData,t;return this.ready&&this.cropped&&(t={left:e.left,top:e.top,width:e.width,height:e.height}),t||{}},setCropBoxData:function(e){var t=this.cropBoxData,r=this.options.aspectRatio,a,n;return this.ready&&this.cropped&&!this.disabled&&qe(e)&&(I(e.left)&&(t.left=e.left),I(e.top)&&(t.top=e.top),I(e.width)&&e.width!==t.width&&(a=!0,t.width=e.width),I(e.height)&&e.height!==t.height&&(n=!0,t.height=e.height),r&&(a?t.height=t.width/r:n&&(t.width=t.height*r)),this.renderCropBox()),this},getCroppedCanvas:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this.ready||!window.HTMLCanvasElement)return null;var t=this.canvasData,r=Nn(this.image,this.imageData,t,e);if(!this.cropped)return r;var a=this.getData(),n=a.x,s=a.y,l=a.width,o=a.height,h=r.width/Math.floor(t.naturalWidth);h!==1&&(n*=h,s*=h,l*=h,o*=h);var u=l/o,c=Ie({aspectRatio:u,width:e.maxWidth||1/0,height:e.maxHeight||1/0}),f=Ie({aspectRatio:u,width:e.minWidth||0,height:e.minHeight||0},"cover"),d=Ie({aspectRatio:u,width:e.width||(h!==1?r.width:l),height:e.height||(h!==1?r.height:o)}),_=d.width,v=d.height;_=Math.min(c.width,Math.max(f.width,_)),v=Math.min(c.height,Math.max(f.height,v));var E=document.createElement("canvas"),N=E.getContext("2d");E.width=Ze(_),E.height=Ze(v),N.fillStyle=e.fillColor||"transparent",N.fillRect(0,0,_,v);var C=e.imageSmoothingEnabled,A=C===void 0?!0:C,ee=e.imageSmoothingQuality;N.imageSmoothingEnabled=A,ee&&(N.imageSmoothingQuality=ee);var y=r.width,g=r.height,M=n,S=s,z,x,se,le,Y,Q;M<=-l||M>y?(M=0,z=0,se=0,Y=0):M<=0?(se=-M,M=0,z=Math.min(y,l+M),Y=z):M<=y&&(se=0,z=Math.min(l,y-M),Y=z),z<=0||S<=-o||S>g?(S=0,x=0,le=0,Q=0):S<=0?(le=-S,S=0,x=Math.min(g,o+S),Q=x):S<=g&&(le=0,x=Math.min(o,g-S),Q=x);var J=[M,S,z,x];if(Y>0&&Q>0){var oe=_/l;J.push(se*oe,le*oe,Y*oe,Q*oe)}return N.drawImage.apply(N,[r].concat(Ki(J.map(function(U){return Math.floor(Ze(U))})))),E},setAspectRatio:function(e){var t=this.options;return!this.disabled&&!Bt(e)&&(t.aspectRatio=Math.max(0,e)||NaN,this.ready&&(this.initCropBox(),this.cropped&&this.renderCropBox())),this},setDragMode:function(e){var t=this.options,r=this.dragBox,a=this.face;if(this.ready&&!this.disabled){var n=e===$t,s=t.movable&&e===$i;e=n||s?e:er,t.dragMode=e,at(r,nt,e),Ge(r,Wt,n),Ge(r,Yt,s),t.cropBoxMovable||(at(a,nt,e),Ge(a,Wt,n),Ge(a,Yt,s))}return this}},Gn=Oe.Cropper,lr=function(){function i(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(an(this,i),!e||!vn.test(e.tagName))throw new Error("The first argument is required and must be an <img> or <canvas> element.");this.element=e,this.options=Z({},Ei,qe(t)&&t),this.cropped=!1,this.disabled=!1,this.pointers={},this.ready=!1,this.reloading=!1,this.replaced=!1,this.sized=!1,this.sizing=!1,this.init()}return sn(i,[{key:"init",value:function(){var t=this.element,r=t.tagName.toLowerCase(),a;if(!t[F]){if(t[F]=this,r==="img"){if(this.isImg=!0,a=t.getAttribute("src")||"",this.originalUrl=a,!a)return;a=t.src}else r==="canvas"&&window.HTMLCanvasElement&&(a=t.toDataURL());this.load(a)}}},{key:"load",value:function(t){var r=this;if(t){this.url=t,this.imageData={};var a=this.element,n=this.options;if(!n.rotatable&&!n.scalable&&(n.checkOrientation=!1),!n.checkOrientation||!window.ArrayBuffer){this.clone();return}if(pn.test(t)){bn.test(t)?this.read(Bn(t)):this.clone();return}var s=new XMLHttpRequest,l=this.clone.bind(this);this.reloading=!0,this.xhr=s,s.onabort=l,s.onerror=l,s.ontimeout=l,s.onprogress=function(){s.getResponseHeader("content-type")!==ki&&s.abort()},s.onload=function(){r.read(s.response)},s.onloadend=function(){r.reloading=!1,r.xhr=null},n.checkCrossOrigin&&Mi(t)&&a.crossOrigin&&(t=Oi(t)),s.open("GET",t,!0),s.responseType="arraybuffer",s.withCredentials=a.crossOrigin==="use-credentials",s.send()}}},{key:"read",value:function(t){var r=this.options,a=this.imageData,n=Pn(t),s=0,l=1,o=1;if(n>1){this.url=Hn(t,ki);var h=Wn(n);s=h.rotate,l=h.scaleX,o=h.scaleY}r.rotatable&&(a.rotate=s),r.scalable&&(a.scaleX=l,a.scaleY=o),this.clone()}},{key:"clone",value:function(){var t=this.element,r=this.url,a=t.crossOrigin,n=r;this.options.checkCrossOrigin&&Mi(r)&&(a||(a="anonymous"),n=Oi(r)),this.crossOrigin=a,this.crossOriginUrl=n;var s=document.createElement("img");a&&(s.crossOrigin=a),s.src=n||r,s.alt=t.alt||"The image to crop",this.image=s,s.onload=this.start.bind(this),s.onerror=this.stop.bind(this),ae(s,mi),t.parentNode.insertBefore(s,t.nextSibling)}},{key:"start",value:function(){var t=this,r=this.image;r.onload=null,r.onerror=null,this.sizing=!0;var a=Oe.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(Oe.navigator.userAgent),n=function(h,u){Z(t.imageData,{naturalWidth:h,naturalHeight:u,aspectRatio:h/u}),t.initialImageData=Z({},t.imageData),t.sizing=!1,t.sized=!0,t.build()};if(r.naturalWidth&&!a){n(r.naturalWidth,r.naturalHeight);return}var s=document.createElement("img"),l=document.body||document.documentElement;this.sizingImage=s,s.onload=function(){n(s.width,s.height),a||l.removeChild(s)},s.src=r.src,a||(s.style.cssText="left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;",l.appendChild(s))}},{key:"stop",value:function(){var t=this.image;t.onload=null,t.onerror=null,t.parentNode.removeChild(t),this.image=null}},{key:"build",value:function(){if(!(!this.sized||this.ready)){var t=this.element,r=this.options,a=this.image,n=t.parentNode,s=document.createElement("div");s.innerHTML=wn;var l=s.querySelector(".".concat(F,"-container")),o=l.querySelector(".".concat(F,"-canvas")),h=l.querySelector(".".concat(F,"-drag-box")),u=l.querySelector(".".concat(F,"-crop-box")),c=u.querySelector(".".concat(F,"-face"));this.container=n,this.cropper=l,this.canvas=o,this.dragBox=h,this.cropBox=u,this.viewBox=l.querySelector(".".concat(F,"-view-box")),this.face=c,o.appendChild(a),ae(t,de),n.insertBefore(l,t.nextSibling),this.isImg||Me(a,mi),this.initPreview(),this.bind(),r.initialAspectRatio=Math.max(0,r.initialAspectRatio)||NaN,r.aspectRatio=Math.max(0,r.aspectRatio)||NaN,r.viewMode=Math.max(0,Math.min(3,Math.round(r.viewMode)))||0,ae(u,de),r.guides||ae(u.getElementsByClassName("".concat(F,"-dashed")),de),r.center||ae(u.getElementsByClassName("".concat(F,"-center")),de),r.background&&ae(l,"".concat(F,"-bg")),r.highlight||ae(c,fn),r.cropBoxMovable&&(ae(c,Yt),at(c,nt,xt)),r.cropBoxResizable||(ae(u.getElementsByClassName("".concat(F,"-line")),de),ae(u.getElementsByClassName("".concat(F,"-point")),de)),this.render(),this.ready=!0,this.setDragMode(r.dragMode),r.autoCrop&&this.crop(),this.setData(r.data),fe(r.ready)&&ke(t,vi,r.ready,{once:!0}),Ke(t,vi)}}},{key:"unbuild",value:function(){this.ready&&(this.ready=!1,this.unbind(),this.resetPreview(),this.cropper.parentNode.removeChild(this.cropper),Me(this.element,de))}},{key:"uncreate",value:function(){this.ready?(this.unbuild(),this.ready=!1,this.cropped=!1):this.sizing?(this.sizingImage.onload=null,this.sizing=!1,this.sized=!1):this.reloading?(this.xhr.onabort=null,this.xhr.abort()):this.image&&this.stop()}}],[{key:"noConflict",value:function(){return window.Cropper=Gn,i}},{key:"setDefaults",value:function(t){Z(Ei,qe(t)&&t)}}]),i}();Z(lr.prototype,Yn,Xn,Un,jn,Vn,qn);function Fn(i){let e,t;return{c(){e=K("img"),me(e.src,t=i[0])||m(e,"src",t),m(e,"alt","")},m(r,a){O(r,e,a),i[4](e)},p(r,[a]){a&1&&!me(e.src,t=r[0])&&m(e,"src",t)},i:W,o:W,d(r){r&&T(e),i[4](null)}}}function Zn(i,e,t){let{image:r}=e,a;const n=st();let s;function l(){s.destroy()}function o(){s&&l(),s=new lr(a,{autoCropArea:1,cropend(){const u=s.getCroppedCanvas().toDataURL();n("crop",u)}}),n("crop",r)}function h(u){j[u?"unshift":"push"](()=>{a=u,t(1,a)})}return i.$$set=u=>{"image"in u&&t(0,r=u.image)},[r,a,l,o,h]}class hr extends pe{constructor(e){super(),be(this,e,Zn,Fn,he,{image:0,destroy:2,create:3})}get image(){return this.$$.ctx[0]}set image(e){this.$$set({image:e}),G()}get destroy(){return this.$$.ctx[2]}get create(){return this.$$.ctx[3]}}class Ti{constructor(e,t){this.x=e,this.y=t}}class Ci extends Ti{update(e){this.x=e.x,this.y=e.y}moveByAngle(e,t){const r=e+Math.PI/2;this.x=this.x+Math.sin(r)*t,this.y=this.y-Math.cos(r)*t}equalsTo(e){return this.x===e.x&&this.y===e.y}getDifferenceTo(e){return new Ti(this.x-e.x,this.y-e.y)}getDistanceTo(e){const t=this.getDifferenceTo(e);return Math.sqrt(Math.pow(t.x,2)+Math.pow(t.y,2))}getAngleTo(e){const t=this.getDifferenceTo(e);return Math.atan2(t.y,t.x)}toObject(){return{x:this.x,y:this.y}}}const Kn=30;class Qn{constructor({radius:e=Kn,enabled:t=!0,initialPoint:r={x:0,y:0}}={}){this.radius=e,this._isEnabled=t,this.pointer=new Ci(r.x,r.y),this.brush=new Ci(r.x,r.y),this.angle=0,this.distance=0,this._hasMoved=!1}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}isEnabled(){return this._isEnabled}setRadius(e){this.radius=e}getRadius(){return this.radius}getBrushCoordinates(){return this.brush.toObject()}getPointerCoordinates(){return this.pointer.toObject()}getBrush(){return this.brush}getPointer(){return this.pointer}getAngle(){return this.angle}getDistance(){return this.distance}brushHasMoved(){return this._hasMoved}update(e,{both:t=!1}={}){return this._hasMoved=!1,this.pointer.equalsTo(e)&&!t?!1:(this.pointer.update(e),t?(this._hasMoved=!0,this.brush.update(e),!0):(this._isEnabled?(this.distance=this.pointer.getDistanceTo(this.brush),this.angle=this.pointer.getAngleTo(this.brush),this.distance>this.radius&&(this.brush.moveByAngle(this.angle,this.distance-this.radius),this._hasMoved=!0)):(this.distance=0,this.angle=0,this.brush.update(e),this._hasMoved=!0),!0))}}var ur=function(){if(typeof Map<"u")return Map;function i(e,t){var r=-1;return e.some(function(a,n){return a[0]===t?(r=n,!0):!1}),r}return function(){function e(){this.__entries__=[]}return Object.defineProperty(e.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),e.prototype.get=function(t){var r=i(this.__entries__,t),a=this.__entries__[r];return a&&a[1]},e.prototype.set=function(t,r){var a=i(this.__entries__,t);~a?this.__entries__[a][1]=r:this.__entries__.push([t,r])},e.prototype.delete=function(t){var r=this.__entries__,a=i(r,t);~a&&r.splice(a,1)},e.prototype.has=function(t){return!!~i(this.__entries__,t)},e.prototype.clear=function(){this.__entries__.splice(0)},e.prototype.forEach=function(t,r){r===void 0&&(r=null);for(var a=0,n=this.__entries__;a<n.length;a++){var s=n[a];t.call(r,s[1],s[0])}},e}()}(),Ft=typeof window<"u"&&typeof document<"u"&&window.document===document,Dt=function(){return typeof global<"u"&&global.Math===Math?global:typeof self<"u"&&self.Math===Math?self:typeof window<"u"&&window.Math===Math?window:Function("return this")()}(),Jn=function(){return typeof requestAnimationFrame=="function"?requestAnimationFrame.bind(Dt):function(i){return setTimeout(function(){return i(Date.now())},1e3/60)}}(),xn=2;function $n(i,e){var t=!1,r=!1,a=0;function n(){t&&(t=!1,i()),r&&l()}function s(){Jn(n)}function l(){var o=Date.now();if(t){if(o-a<xn)return;r=!0}else t=!0,r=!1,setTimeout(s,e);a=o}return l}var ea=20,ta=["top","right","bottom","left","width","height","size","weight"],ia=typeof MutationObserver<"u",ra=function(){function i(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=$n(this.refresh.bind(this),ea)}return i.prototype.addObserver=function(e){~this.observers_.indexOf(e)||this.observers_.push(e),this.connected_||this.connect_()},i.prototype.removeObserver=function(e){var t=this.observers_,r=t.indexOf(e);~r&&t.splice(r,1),!t.length&&this.connected_&&this.disconnect_()},i.prototype.refresh=function(){var e=this.updateObservers_();e&&this.refresh()},i.prototype.updateObservers_=function(){var e=this.observers_.filter(function(t){return t.gatherActive(),t.hasActive()});return e.forEach(function(t){return t.broadcastActive()}),e.length>0},i.prototype.connect_=function(){!Ft||this.connected_||(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),ia?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},i.prototype.disconnect_=function(){!Ft||!this.connected_||(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},i.prototype.onTransitionEnd_=function(e){var t=e.propertyName,r=t===void 0?"":t,a=ta.some(function(n){return!!~r.indexOf(n)});a&&this.refresh()},i.getInstance=function(){return this.instance_||(this.instance_=new i),this.instance_},i.instance_=null,i}(),cr=function(i,e){for(var t=0,r=Object.keys(e);t<r.length;t++){var a=r[t];Object.defineProperty(i,a,{value:e[a],enumerable:!1,writable:!1,configurable:!0})}return i},Qe=function(i){var e=i&&i.ownerDocument&&i.ownerDocument.defaultView;return e||Dt},fr=Rt(0,0,0,0);function Mt(i){return parseFloat(i)||0}function Ri(i){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];return e.reduce(function(r,a){var n=i["border-"+a+"-width"];return r+Mt(n)},0)}function na(i){for(var e=["top","right","bottom","left"],t={},r=0,a=e;r<a.length;r++){var n=a[r],s=i["padding-"+n];t[n]=Mt(s)}return t}function aa(i){var e=i.getBBox();return Rt(0,0,e.width,e.height)}function sa(i){var e=i.clientWidth,t=i.clientHeight;if(!e&&!t)return fr;var r=Qe(i).getComputedStyle(i),a=na(r),n=a.left+a.right,s=a.top+a.bottom,l=Mt(r.width),o=Mt(r.height);if(r.boxSizing==="border-box"&&(Math.round(l+n)!==e&&(l-=Ri(r,"left","right")+n),Math.round(o+s)!==t&&(o-=Ri(r,"top","bottom")+s)),!la(i)){var h=Math.round(l+n)-e,u=Math.round(o+s)-t;Math.abs(h)!==1&&(l-=h),Math.abs(u)!==1&&(o-=u)}return Rt(a.left,a.top,l,o)}var oa=function(){return typeof SVGGraphicsElement<"u"?function(i){return i instanceof Qe(i).SVGGraphicsElement}:function(i){return i instanceof Qe(i).SVGElement&&typeof i.getBBox=="function"}}();function la(i){return i===Qe(i).document.documentElement}function ha(i){return Ft?oa(i)?aa(i):sa(i):fr}function ua(i){var e=i.x,t=i.y,r=i.width,a=i.height,n=typeof DOMRectReadOnly<"u"?DOMRectReadOnly:Object,s=Object.create(n.prototype);return cr(s,{x:e,y:t,width:r,height:a,top:t,right:e+r,bottom:a+t,left:e}),s}function Rt(i,e,t,r){return{x:i,y:e,width:t,height:r}}var ca=function(){function i(e){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=Rt(0,0,0,0),this.target=e}return i.prototype.isActive=function(){var e=ha(this.target);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},i.prototype.broadcastRect=function(){var e=this.contentRect_;return this.broadcastWidth=e.width,this.broadcastHeight=e.height,e},i}(),fa=function(){function i(e,t){var r=ua(t);cr(this,{target:e,contentRect:r})}return i}(),da=function(){function i(e,t,r){if(this.activeObservations_=[],this.observations_=new ur,typeof e!="function")throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=e,this.controller_=t,this.callbackCtx_=r}return i.prototype.observe=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(e instanceof Qe(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)||(t.set(e,new ca(e)),this.controller_.addObserver(this),this.controller_.refresh())}},i.prototype.unobserve=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(e instanceof Qe(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)&&(t.delete(e),t.size||this.controller_.removeObserver(this))}},i.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},i.prototype.gatherActive=function(){var e=this;this.clearActive(),this.observations_.forEach(function(t){t.isActive()&&e.activeObservations_.push(t)})},i.prototype.broadcastActive=function(){if(this.hasActive()){var e=this.callbackCtx_,t=this.activeObservations_.map(function(r){return new fa(r.target,r.broadcastRect())});this.callback_.call(e,t,e),this.clearActive()}},i.prototype.clearActive=function(){this.activeObservations_.splice(0)},i.prototype.hasActive=function(){return this.activeObservations_.length>0},i}(),dr=typeof WeakMap<"u"?new WeakMap:new ur,mr=function(){function i(e){if(!(this instanceof i))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var t=ra.getInstance(),r=new da(e,t,this);dr.set(this,r)}return i}();["observe","unobserve","disconnect"].forEach(function(i){mr.prototype[i]=function(){var e;return(e=dr.get(this))[i].apply(e,arguments)}});var ma=function(){return typeof Dt.ResizeObserver<"u"?Dt.ResizeObserver:mr}();function Ai(i,e,t){const r=i.slice();return r[61]=e[t].name,r[62]=e[t].zIndex,r[63]=e[t].opacity,r[64]=e,r[65]=t,r}function Si(i){let e,t,r;return{c(){e=K("div"),e.textContent="Start drawing",m(e,"class","start-prompt svelte-yigbas")},m(a,n){O(a,e,n),r=!0},i(a){r||(a&&Kt(()=>{r&&(t||(t=ai(e,oi,{duration:50},!0)),t.run(1))}),r=!0)},o(a){a&&(t||(t=ai(e,oi,{duration:50},!1)),t.run(0)),r=!1},d(a){a&&T(e),a&&t&&t.end()}}}function Ii(i){let e,t=i[61],r,a;const n=()=>i[31](e,t),s=()=>i[31](null,t);return{c(){e=K("canvas"),m(e,"key",i[61]),si(e,"z-index",i[62]),m(e,"class","svelte-yigbas"),X(e,"lr",i[5]),X(e,"tb",!i[5]),si(e,"opacity",i[63])},m(l,o){O(l,e,o),n(),r||(a=[ie(e,"mousedown",i[61]==="interface"?i[7]:void 0),ie(e,"mousemove",i[61]==="interface"?i[8]:void 0),ie(e,"mouseup",i[61]==="interface"?i[9]:void 0),ie(e,"mouseout",i[61]==="interface"?i[9]:void 0),ie(e,"blur",i[61]==="interface"?i[9]:void 0),ie(e,"touchstart",i[61]==="interface"?i[7]:void 0),ie(e,"touchmove",i[61]==="interface"?i[8]:void 0),ie(e,"touchend",i[61]==="interface"?i[9]:void 0),ie(e,"touchcancel",i[61]==="interface"?i[9]:void 0),ie(e,"click",vr(i[30]))],r=!0)},p(l,o){i=l,t!==i[61]&&(s(),t=i[61],n()),o[0]&32&&X(e,"lr",i[5]),o[0]&32&&X(e,"tb",!i[5])},d(l){l&&T(e),s(),r=!1,Gi(a)}}}function ga(i){let e,t,r,a=i[4]===0&&Si(),n=ni(i[6]),s=[];for(let l=0;l<n.length;l+=1)s[l]=Ii(Ai(i,n,l));return{c(){e=K("div"),a&&a.c(),t=$();for(let l=0;l<s.length;l+=1)s[l].c();m(e,"class","wrap svelte-yigbas"),Kt(()=>i[33].call(e))},m(l,o){O(l,e,o),a&&a.m(e,null),V(e,t);for(let h=0;h<s.length;h+=1)s[h]&&s[h].m(e,null);i[32](e),r=qi(e,i[33].bind(e))},p(l,o){if(l[4]===0?a?o[0]&16&&w(a,1):(a=Si(),a.c(),w(a,1),a.m(e,t)):a&&(ve(),D(a,1,1,()=>{a=null}),we()),o[0]&993){n=ni(l[6]);let h;for(h=0;h<n.length;h+=1){const u=Ai(l,n,h);s[h]?s[h].p(u,o):(s[h]=Ii(u),s[h].c(),s[h].m(e,null))}for(;h<s.length;h+=1)s[h].d(1);s.length=n.length}},i(l){w(a)},o(l){D(a)},d(l){l&&T(e),a&&a.d(),pr(s,l),i[32](null),r()}}}let _a="#aaa";function pa(i,e){return{x:i.x+(e.x-i.x)/2,y:i.y+(e.y-i.y)/2}}function ba(i,e,t){let r;const a=st();let{value:n}=e,{value_img:s}=e,{mode:l="sketch"}=e,{brush_color:o="#0b0f19"}=e,{brush_radius:h}=e,{mask_opacity:u=.7}=e,{source:c}=e,{width:f=400}=e,{height:d=200}=e,{container_height:_=200}=e,{shape:v}=e,E,N=f,C=d,A;const ee=[{name:"interface",zIndex:15},{name:"mask",zIndex:13,opacity:u},{name:"drawing",zIndex:11},{name:"temp",zIndex:12}];let y={},g={},M=[],S=[],z=!0,x=!0,se=!1,le=!1,Y=null,Q=null,J=null,oe=0;function U(){if(!v){g.temp.drawImage(s,0,0,f,d);return}let p=s.naturalWidth,R=s.naturalHeight;const L=v[0]/v[1],ne=p/R;let q=0,ce=0;L<ne?(p=v[1]*ne,R=v[1],q=(v[0]-p)/2):L>ne?(p=v[0],R=v[0]/ne,ce=(v[1]-R)/2):(q=0,ce=0,p=v[0],R=v[1]),g.temp.drawImage(s,q,ce,p,R)}Zt(async()=>{Object.keys(y).forEach(p=>{t(27,g[p]=y[p].getContext("2d"),g)}),await Be(),s&&(s.addEventListener("load",p=>{c==="webcam"?(g.temp.save(),g.temp.translate(f,0),g.temp.scale(-1,1),g.temp.drawImage(s,0,0),g.temp.restore()):U(),g.drawing.drawImage(y.temp,0,0,f,d),Te()}),setTimeout(()=>{c==="webcam"?(g.temp.save(),g.temp.translate(f,0),g.temp.scale(-1,1),g.temp.drawImage(s,0,0),g.temp.restore()):U(),g.drawing.drawImage(y.temp,0,0,f,d),Ce({lines:S.slice()}),Te()},100)),t(29,Y=new Qn({radius:h*.05,enabled:!0,initialPoint:{x:f/2,y:d/2}})),J=new ma((p,R,...L)=>{ct()}),J.observe(Q),xe(),t(25,E=!0),requestAnimationFrame(()=>{ue(),requestAnimationFrame(()=>{Ne()})})});function ue(){const p=f/2,R=d/2;Y.update({x:p,y:R},{both:!0}),Y.update({x:p,y:R},{both:!1}),z=!0,x=!0}br(()=>{t(25,E=!1),J.unobserve(Q)});function ye(p){pt(),s&&(c==="webcam"?(g.temp.save(),g.temp.translate(f,0),g.temp.scale(-1,1),g.temp.drawImage(s,0,0),g.temp.restore()):U(),(!S||!S.length)&&g.drawing.drawImage(y.temp,0,0,f,d)),Ce({lines:p}),t(4,oe=p.length),t(28,S=p),g.drawing.drawImage(y.temp,0,0,f,d),S.length==0&&a("clear")}function k(){ye([]),Te()}function Ee(){const p=S.slice(0,-1);ye(p),Te()}let Ce=({lines:p})=>{p.forEach(R=>{const{points:L,brush_color:ne,brush_radius:q}=R;mt({points:L,brush_color:ne,brush_radius:q,mask:l==="mask"})}),_t(),l==="mask"&&gt()},We=p=>{p.preventDefault(),le=!0;const{x:R,y:L}=ft(p);p.touches&&p.touches.length>0&&Y.update({x:R,y:L},{both:!0}),dt(R,L),t(4,oe+=1)},Ye=p=>{p.preventDefault();const{x:R,y:L}=ft(p);dt(R,L)},Je=p=>{p.preventDefault(),Ye(p),se=!1,le=!1,_t(),l==="mask"&&gt()},ot=0,lt=0,ht=0,ut=!1,ct=async()=>{if(v&&Q){const L=Q?.getBoundingClientRect(),ne=v[0]/v[1],q=L.width/L.height;t(5,ut=ne<q)}if(f===ot&&d===lt&&ht===_)return;const p={width:f,height:d},R={height:_,width:_*(p.width/p.height)};await Promise.all([Xe(y.interface,p,R),Xe(y.drawing,p,R),Xe(y.temp,p,R),Xe(y.mask,p,R,!1)]),h||t(10,h=20*(p.width/R.width)),xe({once:!0}),setTimeout(()=>{lt=d,ot=f,ht=_},10),await Be(),Ne()},Xe=async(p,R,L,ne=!0)=>{if(!E)return;await Be();const q=window.devicePixelRatio||1;p.width=R.width*(ne?q:1),p.height=R.height*(ne?q:1);const ce=p.getContext("2d");ne&&ce.scale(q,q),p.style.width=`${L.width}px`,p.style.height=`${L.height}px`},ft=p=>{const R=y.interface.getBoundingClientRect();let L=p.clientX,ne=p.clientY;return p.changedTouches&&p.changedTouches.length>0&&(L=p.changedTouches[0].clientX,ne=p.changedTouches[0].clientY),{x:(L-R.left)/R.width*f,y:(ne-R.top)/R.height*d}},dt=(p,R)=>{Y.update({x:p,y:R});const L=!Y.isEnabled();(le&&!se||L&&le)&&(se=!0,M.push(Y.brush.toObject())),se&&(M.push(Y.brush.toObject()),mt({points:M,brush_color:o,brush_radius:h,mask:l==="mask"})),z=!0},mt=({points:p,brush_color:R,brush_radius:L,mask:ne})=>{if(!p||p.length<2)return;let q=ne?g.mask:g.temp;q.lineJoin="round",q.lineCap="round",q.strokeStyle=R,q.lineWidth=L;let ce=p[0],Ue=p[1];q.moveTo(Ue.x,Ue.y),q.beginPath();for(var je=1,Lt=p.length;je<Lt;je++){var b=pa(ce,Ue);q.quadraticCurveTo(ce.x,ce.y,b.x,b.y),ce=p[je],Ue=p[je+1]}q.lineTo(ce.x,ce.y),q.stroke()},gt=()=>{M.length<1||(M.length=0,Te())},_t=()=>{M.length<1||(S.push({points:M.slice(),brush_color:o,brush_radius:h}),l!=="mask"&&(M.length=0),g.drawing.drawImage(y.temp,0,0,f,d),Te())},Te=()=>{const p=bt();a("change",p)};function Ne(){return t(28,S=[]),pt(),t(4,oe=0),!0}function pt(){x=!0,g.temp.clearRect(0,0,f,d),t(27,g.temp.fillStyle=l==="mask"?"transparent":"#FFFFFF",g),g.temp.fillRect(0,0,f,d),l==="mask"&&g.mask.clearRect(0,0,y.mask.width,y.mask.height)}let xe=({once:p=!1}={})=>{if(z||x){const R=Y.getPointerCoordinates(),L=Y.getBrushCoordinates();At(g.interface,R,L),z=!1,x=!1}p||window.requestAnimationFrame(()=>{xe()})},At=(p,R,L)=>{p.clearRect(0,0,f,d),p.beginPath(),p.fillStyle=o,p.arc(L.x,L.y,h/2,0,Math.PI*2,!0),p.fill(),p.beginPath(),p.fillStyle=_a,p.arc(L.x,L.y,r,0,Math.PI*2,!0),p.fill()};function bt(){return l==="mask"?y.mask.toDataURL("image/png"):y.drawing.toDataURL("image/jpg")}function St(p){Fi.call(this,i,p)}function It(p,R){j[p?"unshift":"push"](()=>{y[R]=p,t(0,y)})}function Nt(p){j[p?"unshift":"push"](()=>{Q=p,t(3,Q)})}function zt(){N=this.offsetWidth,C=this.offsetHeight,t(1,N),t(2,C)}return i.$$set=p=>{"value"in p&&t(13,n=p.value),"value_img"in p&&t(14,s=p.value_img),"mode"in p&&t(15,l=p.mode),"brush_color"in p&&t(16,o=p.brush_color),"brush_radius"in p&&t(10,h=p.brush_radius),"mask_opacity"in p&&t(17,u=p.mask_opacity),"source"in p&&t(18,c=p.source),"width"in p&&t(11,f=p.width),"height"in p&&t(12,d=p.height),"container_height"in p&&t(19,_=p.container_height),"shape"in p&&t(20,v=p.shape)},i.$$.update=()=>{i.$$.dirty[0]&1054720&&v&&(f||d)&&(t(11,f=v[0]),t(12,d=v[1])),i.$$.dirty[0]&33562624&&E&&!n&&Ne(),i.$$.dirty[0]&503601153&&E&&s!==A&&(t(26,A=s),Ne(),setTimeout(()=>{c==="webcam"?(g.temp.save(),g.temp.translate(f,0),g.temp.scale(-1,1),g.temp.drawImage(s,0,0),g.temp.restore()):U(),g.drawing.drawImage(y.temp,0,0,f,d),Ce({lines:S.slice()}),Te()},50)),i.$$.dirty[0]&536871936&&Y&&(ue(),Y.setRadius(h*.05)),i.$$.dirty[0]&6144&&(f||d)&&ct(),i.$$.dirty[0]&1024&&(r=h*.075)},[y,N,C,Q,oe,ut,ee,We,Ye,Je,h,f,d,n,s,l,o,u,c,_,v,k,Ee,Ne,bt,E,A,g,S,Y,St,It,Nt,zt]}class ti extends pe{constructor(e){super(),be(this,e,ba,ga,he,{value:13,value_img:14,mode:15,brush_color:16,brush_radius:10,mask_opacity:17,source:18,width:11,height:12,container_height:19,shape:20,clear_mask:21,undo:22,clear:23,get_image_data:24},null,[-1,-1,-1])}get clear_mask(){return this.$$.ctx[21]}get undo(){return this.$$.ctx[22]}get clear(){return this.$$.ctx[23]}get get_image_data(){return this.$$.ctx[24]}}function va(i){let e,t;return e=new Fe({props:{Icon:Gr,label:"Clear"}}),e.$on("click",i[3]),{c(){B(e.$$.fragment)},m(r,a){H(e,r,a),t=!0},p:W,i(r){t||(w(e.$$.fragment,r),t=!0)},o(r){D(e.$$.fragment,r),t=!1},d(r){P(e,r)}}}function wa(i){let e,t,r,a,n,s,l,o,h;t=new Fe({props:{Icon:Nr,label:"Undo"}}),t.$on("click",i[1]),n=new Fe({props:{Icon:Ir,label:"Redraw"}}),n.$on("click",i[2]);let u=va(i);return o=new Fe({props:{Icon:Sr,label:"Remove Image"}}),o.$on("click",i[4]),{c(){e=K("div"),B(t.$$.fragment),r=$(),a=K("span"),B(n.$$.fragment),s=$(),u&&u.c(),l=$(),B(o.$$.fragment),m(a,"class","hide_redraw svelte-q8xc61"),m(e,"class","svelte-q8xc61")},m(c,f){O(c,e,f),H(t,e,null),V(e,r),V(e,a),H(n,a,null),V(e,s),u&&u.m(e,null),V(e,l),H(o,e,null),h=!0},p(c,[f]){u.p(c,f)},i(c){h||(w(t.$$.fragment,c),w(n.$$.fragment,c),w(u),w(o.$$.fragment,c),h=!0)},o(c){D(t.$$.fragment,c),D(n.$$.fragment,c),D(u),D(o.$$.fragment,c),h=!1},d(c){c&&T(e),P(t),P(n),u&&u.d(),P(o)}}}function ya(i){const e=st();return[e,()=>e("undo"),()=>e("redraw"),s=>{e("clear_mask"),s.stopPropagation()},s=>{e("remove_image"),s.stopPropagation()}]}class ii extends pe{constructor(e){super(),be(this,e,ya,wa,he,{})}}function Ni(i){let e,t,r,a,n;return{c(){e=K("input"),m(e,"aria-label","Brush radius"),m(e,"type","range"),m(e,"min",t=.5*(i[2]/i[6])),m(e,"max",r=75*(i[2]/i[6])),m(e,"class","svelte-p4aq0j")},m(s,l){O(s,e,l),kt(e,i[0]),a||(n=[ie(e,"change",i[10]),ie(e,"input",i[10])],a=!0)},p(s,l){l&68&&t!==(t=.5*(s[2]/s[6]))&&m(e,"min",t),l&68&&r!==(r=75*(s[2]/s[6]))&&m(e,"max",r),l&1&&kt(e,s[0])},d(s){s&&T(e),a=!1,Gi(n)}}}function zi(i){let e,t,r,a;t=new Fe({props:{Icon:Vr,label:"Select brush color"}}),t.$on("click",i[11]);let n=i[5]&&Li(i);return{c(){e=K("span"),B(t.$$.fragment),r=$(),n&&n.c(),m(e,"class","col svelte-p4aq0j")},m(s,l){O(s,e,l),H(t,e,null),V(e,r),n&&n.m(e,null),a=!0},p(s,l){s[5]?n?n.p(s,l):(n=Li(s),n.c(),n.m(e,null)):n&&(n.d(1),n=null)},i(s){a||(w(t.$$.fragment,s),a=!0)},o(s){D(t.$$.fragment,s),a=!1},d(s){s&&T(e),P(t),n&&n.d()}}}function Li(i){let e,t,r;return{c(){e=K("input"),m(e,"aria-label","Brush color"),m(e,"type","color"),m(e,"class","svelte-p4aq0j")},m(a,n){O(a,e,n),kt(e,i[1]),t||(r=ie(e,"input",i[12]),t=!0)},p(a,n){n&2&&kt(e,a[1])},d(a){a&&T(e),t=!1,r()}}}function ka(i){let e,t,r,a,n,s;r=new Fe({props:{Icon:Pr,label:"Use brush"}}),r.$on("click",i[9]);let l=i[4]&&Ni(i),o=i[3]!=="mask"&&zi(i);return{c(){e=K("div"),t=K("span"),B(r.$$.fragment),a=$(),l&&l.c(),n=$(),o&&o.c(),m(t,"class","brush svelte-p4aq0j"),m(e,"class","wrap svelte-p4aq0j")},m(h,u){O(h,e,u),V(e,t),H(r,t,null),V(t,a),l&&l.m(t,null),V(e,n),o&&o.m(e,null),s=!0},p(h,[u]){h[4]?l?l.p(h,u):(l=Ni(h),l.c(),l.m(t,null)):l&&(l.d(1),l=null),h[3]!=="mask"?o?(o.p(h,u),u&8&&w(o,1)):(o=zi(h),o.c(),w(o,1),o.m(e,null)):o&&(ve(),D(o,1,1,()=>{o=null}),we())},i(h){s||(w(r.$$.fragment,h),w(o),s=!0)},o(h){D(r.$$.fragment,h),D(o),s=!1},d(h){h&&T(e),P(r),l&&l.d(),o&&o.d()}}}function Ea(i,e,t){let r,a=!1,n=!1,{brush_radius:s=20}=e,{brush_color:l="#000"}=e,{container_height:o}=e,{img_width:h}=e,{img_height:u}=e,{mode:c="other"}=e;const f=()=>t(4,a=!a);function d(){s=wr(this.value),t(0,s)}const _=()=>t(5,n=!n);function v(){l=this.value,t(1,l)}return i.$$set=E=>{"brush_radius"in E&&t(0,s=E.brush_radius),"brush_color"in E&&t(1,l=E.brush_color),"container_height"in E&&t(7,o=E.container_height),"img_width"in E&&t(2,h=E.img_width),"img_height"in E&&t(8,u=E.img_height),"mode"in E&&t(3,c=E.mode)},i.$$.update=()=>{i.$$.dirty&388&&t(6,r=o*(h/u))},[s,l,h,c,a,n,r,o,u,f,d,_,v]}class ri extends pe{constructor(e){super(),be(this,e,Ea,ka,he,{brush_radius:0,brush_color:1,container_height:7,img_width:2,img_height:8,mode:3})}}function Da(i){let e,t,r,a;return{c(){e=K("img"),me(e.src,t=i[0].image||i[0])||m(e,"src",t),m(e,"alt",""),m(e,"class","svelte-p3y7hu"),X(e,"webcam",i[6]==="webcam"&&i[10]),X(e,"selectable",i[11])},m(n,s){O(n,e,s),r||(a=ie(e,"click",i[32]),r=!0)},p(n,s){s[0]&1&&!me(e.src,t=n[0].image||n[0])&&m(e,"src",t),s[0]&1088&&X(e,"webcam",n[6]==="webcam"&&n[10]),s[0]&2048&&X(e,"selectable",n[11])},i:W,o:W,d(n){n&&T(e),r=!1,a()}}}function Ma(i){let e=i[25],t,r,a,n=Bi(i),s=i[20]>0&&Hi(i);return{c(){n.c(),t=$(),s&&s.c(),r=Pe()},m(l,o){n.m(l,o),O(l,t,o),s&&s.m(l,o),O(l,r,o),a=!0},p(l,o){o[0]&33554432&&he(e,e=l[25])?(n.d(1),n=Bi(l),n.c(),n.m(t.parentNode,t)):n.p(l,o),l[20]>0?s?(s.p(l,o),o[0]&1048576&&w(s,1)):(s=Hi(l),s.c(),w(s,1),s.m(r.parentNode,r)):s&&(ve(),D(s,1,1,()=>{s=null}),we())},i(l){a||(w(s),a=!0)},o(l){D(s),a=!1},d(l){l&&(T(t),T(r)),n.d(l),s&&s.d(l)}}}function Oa(i){let e,t,r,a,n,s,l;return e=new Tt({props:{editable:!0}}),e.$on("edit",i[57]),e.$on("clear",i[27]),{c(){B(e.$$.fragment),t=$(),r=K("img"),me(r.src,a=i[0])||m(r,"src",a),m(r,"alt",""),m(r,"class","svelte-p3y7hu"),X(r,"selectable",i[11]),X(r,"webcam",i[6]==="webcam"&&i[10])},m(o,h){H(e,o,h),O(o,t,h),O(o,r,h),n=!0,s||(l=ie(r,"click",i[32]),s=!0)},p(o,h){(!n||h[0]&1&&!me(r.src,a=o[0]))&&m(r,"src",a),(!n||h[0]&2048)&&X(r,"selectable",o[11]),(!n||h[0]&1088)&&X(r,"webcam",o[6]==="webcam"&&o[10])},i(o){n||(w(e.$$.fragment,o),n=!0)},o(o){D(e.$$.fragment,o),n=!1},d(o){o&&(T(t),T(r)),P(e,o),s=!1,l()}}}function Ta(i){let e,t,r,a,n={image:i[0]};return e=new hr({props:n}),i[55](e),e.$on("crop",i[28]),r=new Tt({}),r.$on("clear",i[56]),{c(){B(e.$$.fragment),t=$(),B(r.$$.fragment)},m(s,l){H(e,s,l),O(s,t,l),H(r,s,l),a=!0},p(s,l){const o={};l[0]&1&&(o.image=s[0]),e.$set(o)},i(s){a||(w(e.$$.fragment,s),w(r.$$.fragment,s),a=!0)},o(s){D(e.$$.fragment,s),D(r.$$.fragment,s),a=!1},d(s){s&&T(t),i[55](null),P(e,s),P(r,s)}}}function Ca(i){let e,t,r=i[6]==="webcam"&&!i[25]&&Wi(i);return{c(){r&&r.c(),e=Pe()},m(a,n){r&&r.m(a,n),O(a,e,n),t=!0},p(a,n){a[6]==="webcam"&&!a[25]?r?(r.p(a,n),n[0]&33554496&&w(r,1)):(r=Wi(a),r.c(),w(r,1),r.m(e.parentNode,e)):r&&(ve(),D(r,1,1,()=>{r=null}),we())},i(a){t||(w(r),t=!0)},o(a){D(r),t=!1},d(a){a&&T(e),r&&r.d(a)}}}function Ra(i){let e,t,r,a,n,s,l;e=new ii({}),e.$on("undo",i[46]),e.$on("redraw",i[47]),e.$on("clear",i[30]),e.$on("remove_image",i[30]);let o=i[1]==="color-sketch"&&Yi(i);function h(f){i[50](f)}function u(f){i[51](f)}let c={value:i[0],mode:i[15],width:i[20]||i[24],height:i[19]||i[23],container_height:i[21]||i[23],shape:i[7]};return i[2]!==void 0&&(c.brush_radius=i[2]),i[3]!==void 0&&(c.brush_color=i[3]),a=new ti({props:c}),j.push(()=>ge(a,"brush_radius",h)),j.push(()=>ge(a,"brush_color",u)),i[52](a),a.$on("change",i[28]),a.$on("clear",i[30]),{c(){B(e.$$.fragment),t=$(),o&&o.c(),r=$(),B(a.$$.fragment)},m(f,d){H(e,f,d),O(f,t,d),o&&o.m(f,d),O(f,r,d),H(a,f,d),l=!0},p(f,d){f[1]==="color-sketch"?o?(o.p(f,d),d[0]&2&&w(o,1)):(o=Yi(f),o.c(),w(o,1),o.m(r.parentNode,r)):o&&(ve(),D(o,1,1,()=>{o=null}),we());const _={};d[0]&1&&(_.value=f[0]),d[0]&32768&&(_.mode=f[15]),d[0]&17825792&&(_.width=f[20]||f[24]),d[0]&8912896&&(_.height=f[19]||f[23]),d[0]&10485760&&(_.container_height=f[21]||f[23]),d[0]&128&&(_.shape=f[7]),!n&&d[0]&4&&(n=!0,_.brush_radius=f[2],_e(()=>n=!1)),!s&&d[0]&8&&(s=!0,_.brush_color=f[3],_e(()=>s=!1)),a.$set(_)},i(f){l||(w(e.$$.fragment,f),w(o),w(a.$$.fragment,f),l=!0)},o(f){D(e.$$.fragment,f),D(o),D(a.$$.fragment,f),l=!1},d(f){f&&(T(t),T(r)),P(e,f),o&&o.d(f),i[52](null),P(a,f)}}}function Aa(i){let e,t,r;function a(s){i[45](s)}let n={filetype:"image/*",include_file_metadata:!1,disable_click:!!i[0],$$slots:{default:[Ba]},$$scope:{ctx:i}};return i[14]!==void 0&&(n.dragging=i[14]),e=new zr({props:n}),j.push(()=>ge(e,"dragging",a)),e.$on("load",i[26]),{c(){B(e.$$.fragment)},m(s,l){H(e,s,l),r=!0},p(s,l){const o={};l[0]&1&&(o.disable_click=!!s[0]),l[0]&67091919|l[2]&32&&(o.$$scope={dirty:l,ctx:s}),!t&&l[0]&16384&&(t=!0,o.dragging=s[14],_e(()=>t=!1)),e.$set(o)},i(s){r||(w(e.$$.fragment,s),r=!0)},o(s){D(e.$$.fragment,s),r=!1},d(s){P(e,s)}}}function Bi(i){let e,t,r,a;return{c(){e=K("img"),m(e,"class","absolute-img svelte-p3y7hu"),me(e.src,t=i[25]||i[0]?.image||i[0])||m(e,"src",t),m(e,"alt","load-1"),X(e,"webcam",i[6]==="webcam"&&i[10])},m(n,s){O(n,e,s),i[58](e),r||(a=ie(e,"load",i[29]),r=!0)},p(n,s){s[0]&33554433&&!me(e.src,t=n[25]||n[0]?.image||n[0])&&m(e,"src",t),s[0]&1088&&X(e,"webcam",n[6]==="webcam"&&n[10])},d(n){n&&T(e),i[58](null),r=!1,a()}}}function Hi(i){let e,t,r,a,n,s,l,o;function h(d){i[60](d)}function u(d){i[61](d)}let c={value:i[0],mode:i[15],width:i[20]||i[24],height:i[19]||i[23],container_height:i[21]||i[23],value_img:i[22],source:i[6]};i[2]!==void 0&&(c.brush_radius=i[2]),i[3]!==void 0&&(c.brush_color=i[3]),e=new ti({props:c}),i[59](e),j.push(()=>ge(e,"brush_radius",h)),j.push(()=>ge(e,"brush_color",u)),e.$on("change",i[28]),n=new ii({}),n.$on("undo",i[62]),n.$on("redraw",i[63]),n.$on("clear",i[30]),n.$on("remove_image",i[30]);let f=(i[1]==="color-sketch"||i[1]==="sketch")&&Pi(i);return{c(){B(e.$$.fragment),a=$(),B(n.$$.fragment),s=$(),f&&f.c(),l=Pe()},m(d,_){H(e,d,_),O(d,a,_),H(n,d,_),O(d,s,_),f&&f.m(d,_),O(d,l,_),o=!0},p(d,_){const v={};_[0]&1&&(v.value=d[0]),_[0]&32768&&(v.mode=d[15]),_[0]&17825792&&(v.width=d[20]||d[24]),_[0]&8912896&&(v.height=d[19]||d[23]),_[0]&10485760&&(v.container_height=d[21]||d[23]),_[0]&4194304&&(v.value_img=d[22]),_[0]&64&&(v.source=d[6]),!t&&_[0]&4&&(t=!0,v.brush_radius=d[2],_e(()=>t=!1)),!r&&_[0]&8&&(r=!0,v.brush_color=d[3],_e(()=>r=!1)),e.$set(v),d[1]==="color-sketch"||d[1]==="sketch"?f?(f.p(d,_),_[0]&2&&w(f,1)):(f=Pi(d),f.c(),w(f,1),f.m(l.parentNode,l)):f&&(ve(),D(f,1,1,()=>{f=null}),we())},i(d){o||(w(e.$$.fragment,d),w(n.$$.fragment,d),w(f),o=!0)},o(d){D(e.$$.fragment,d),D(n.$$.fragment,d),D(f),o=!1},d(d){d&&(T(a),T(s),T(l)),i[59](null),P(e,d),P(n,d),f&&f.d(d)}}}function Pi(i){let e,t,r,a;function n(o){i[64](o)}function s(o){i[65](o)}let l={container_height:i[21]||i[23],img_width:i[20]||i[24],img_height:i[19]||i[23],mode:i[15]};return i[2]!==void 0&&(l.brush_radius=i[2]),i[3]!==void 0&&(l.brush_color=i[3]),e=new ri({props:l}),j.push(()=>ge(e,"brush_radius",n)),j.push(()=>ge(e,"brush_color",s)),{c(){B(e.$$.fragment)},m(o,h){H(e,o,h),a=!0},p(o,h){const u={};h[0]&10485760&&(u.container_height=o[21]||o[23]),h[0]&17825792&&(u.img_width=o[20]||o[24]),h[0]&8912896&&(u.img_height=o[19]||o[23]),h[0]&32768&&(u.mode=o[15]),!t&&h[0]&4&&(t=!0,u.brush_radius=o[2],_e(()=>t=!1)),!r&&h[0]&8&&(r=!0,u.brush_color=o[3],_e(()=>r=!1)),e.$set(u)},i(o){a||(w(e.$$.fragment,o),a=!0)},o(o){D(e.$$.fragment,o),a=!1},d(o){P(e,o)}}}function Wi(i){let e,t;return e=new nn({props:{streaming:i[8],pending:i[9],mirror_webcam:i[10]}}),e.$on("capture",i[53]),e.$on("stream",i[28]),e.$on("error",i[54]),{c(){B(e.$$.fragment)},m(r,a){H(e,r,a),t=!0},p(r,a){const n={};a[0]&256&&(n.streaming=r[8]),a[0]&512&&(n.pending=r[9]),a[0]&1024&&(n.mirror_webcam=r[10]),e.$set(n)},i(r){t||(w(e.$$.fragment,r),t=!0)},o(r){D(e.$$.fragment,r),t=!1},d(r){P(e,r)}}}function Yi(i){let e,t,r,a;function n(o){i[48](o)}function s(o){i[49](o)}let l={container_height:i[21]||i[23],img_width:i[20]||i[24],img_height:i[19]||i[23]};return i[2]!==void 0&&(l.brush_radius=i[2]),i[3]!==void 0&&(l.brush_color=i[3]),e=new ri({props:l}),j.push(()=>ge(e,"brush_radius",n)),j.push(()=>ge(e,"brush_color",s)),e.$on("redraw",function(){Ot(i[16].redraw())&&i[16].redraw().apply(this,arguments)}),{c(){B(e.$$.fragment)},m(o,h){H(e,o,h),a=!0},p(o,h){i=o;const u={};h[0]&10485760&&(u.container_height=i[21]||i[23]),h[0]&17825792&&(u.img_width=i[20]||i[24]),h[0]&8912896&&(u.img_height=i[19]||i[23]),!t&&h[0]&4&&(t=!0,u.brush_radius=i[2],_e(()=>t=!1)),!r&&h[0]&8&&(r=!0,u.brush_color=i[3],_e(()=>r=!1)),e.$set(u)},i(o){a||(w(e.$$.fragment,o),a=!0)},o(o){D(e.$$.fragment,o),a=!1},d(o){P(e,o)}}}function Sa(i){let e,t,r,a;return{c(){e=K("img"),me(e.src,t=i[0].image||i[0])||m(e,"src",t),m(e,"alt","hello"),m(e,"class","svelte-p3y7hu"),X(e,"webcam",i[6]==="webcam"&&i[10]),X(e,"selectable",i[11])},m(n,s){O(n,e,s),r||(a=ie(e,"click",i[32]),r=!0)},p(n,s){s[0]&1&&!me(e.src,t=n[0].image||n[0])&&m(e,"src",t),s[0]&1088&&X(e,"webcam",n[6]==="webcam"&&n[10]),s[0]&2048&&X(e,"selectable",n[11])},i:W,o:W,d(n){n&&T(e),r=!1,a()}}}function Ia(i){let e=i[25],t,r,a,n=Xi(i),s=i[20]>0&&Ui(i);return{c(){n.c(),t=$(),s&&s.c(),r=Pe()},m(l,o){n.m(l,o),O(l,t,o),s&&s.m(l,o),O(l,r,o),a=!0},p(l,o){o[0]&33554432&&he(e,e=l[25])?(n.d(1),n=Xi(l),n.c(),n.m(t.parentNode,t)):n.p(l,o),l[20]>0?s?(s.p(l,o),o[0]&1048576&&w(s,1)):(s=Ui(l),s.c(),w(s,1),s.m(r.parentNode,r)):s&&(ve(),D(s,1,1,()=>{s=null}),we())},i(l){a||(w(s),a=!0)},o(l){D(s),a=!1},d(l){l&&(T(t),T(r)),n.d(l),s&&s.d(l)}}}function Na(i){let e,t,r,a,n,s,l;return e=new Tt({props:{editable:!0}}),e.$on("edit",i[36]),e.$on("clear",i[27]),{c(){B(e.$$.fragment),t=$(),r=K("img"),me(r.src,a=i[0])||m(r,"src",a),m(r,"alt",""),m(r,"class","svelte-p3y7hu"),X(r,"scale-x-[-1]",i[6]==="webcam"&&i[10]),X(r,"selectable",i[11])},m(o,h){H(e,o,h),O(o,t,h),O(o,r,h),n=!0,s||(l=ie(r,"click",i[32]),s=!0)},p(o,h){(!n||h[0]&1&&!me(r.src,a=o[0]))&&m(r,"src",a),(!n||h[0]&1088)&&X(r,"scale-x-[-1]",o[6]==="webcam"&&o[10]),(!n||h[0]&2048)&&X(r,"selectable",o[11])},i(o){n||(w(e.$$.fragment,o),n=!0)},o(o){D(e.$$.fragment,o),n=!1},d(o){o&&(T(t),T(r)),P(e,o),s=!1,l()}}}function za(i){let e,t,r,a,n={image:i[0]};return e=new hr({props:n}),i[34](e),e.$on("crop",i[28]),r=new Tt({}),r.$on("clear",i[35]),{c(){B(e.$$.fragment),t=$(),B(r.$$.fragment)},m(s,l){H(e,s,l),O(s,t,l),H(r,s,l),a=!0},p(s,l){const o={};l[0]&1&&(o.image=s[0]),e.$set(o)},i(s){a||(w(e.$$.fragment,s),w(r.$$.fragment,s),a=!0)},o(s){D(e.$$.fragment,s),D(r.$$.fragment,s),a=!1},d(s){s&&T(t),i[34](null),P(e,s),P(r,s)}}}function La(i){let e;const t=i[33].default,r=yr(t,i,i[67],null);return{c(){r&&r.c()},m(a,n){r&&r.m(a,n),e=!0},p(a,n){r&&r.p&&(!e||n[2]&32)&&kr(r,t,a,a[67],e?Dr(t,a[67],n,null):Er(a[67]),null)},i(a){e||(w(r,a),e=!0)},o(a){D(r,a),e=!1},d(a){r&&r.d(a)}}}function Xi(i){let e,t,r,a;return{c(){e=K("img"),m(e,"class","absolute-img svelte-p3y7hu"),me(e.src,t=i[25]||i[0]?.image||i[0])||m(e,"src",t),m(e,"data-source",i[17]),m(e,"data-isupload",i[18]),m(e,"alt","load-2"),X(e,"webcam",i[6]==="webcam"&&i[10])},m(n,s){O(n,e,s),i[37](e),r||(a=ie(e,"load",i[29]),r=!0)},p(n,s){s[0]&33554433&&!me(e.src,t=n[25]||n[0]?.image||n[0])&&m(e,"src",t),s[0]&131072&&m(e,"data-source",n[17]),s[0]&262144&&m(e,"data-isupload",n[18]),s[0]&1088&&X(e,"webcam",n[6]==="webcam"&&n[10])},d(n){n&&T(e),i[37](null),r=!1,a()}}}function Ui(i){let e,t,r,a,n,s,l,o;function h(d){i[39](d)}function u(d){i[40](d)}let c={value:i[0],mask_opacity:i[12],mode:i[15],width:i[20]||i[24],height:i[19]||i[23],container_height:i[21]||i[23],value_img:i[22],source:i[6],shape:i[7]};i[2]!==void 0&&(c.brush_radius=i[2]),i[3]!==void 0&&(c.brush_color=i[3]),e=new ti({props:c}),i[38](e),j.push(()=>ge(e,"brush_radius",h)),j.push(()=>ge(e,"brush_color",u)),e.$on("change",i[28]),e.$on("redraw",function(){Ot(i[16].redraw())&&i[16].redraw().apply(this,arguments)}),n=new ii({props:{show_eraser:i[22]}}),n.$on("undo",i[41]),n.$on("redraw",i[42]),n.$on("clear_mask",i[31]),n.$on("remove_image",i[30]);let f=(i[1]==="color-sketch"||i[1]==="sketch")&&ji(i);return{c(){B(e.$$.fragment),a=$(),B(n.$$.fragment),s=$(),f&&f.c(),l=Pe()},m(d,_){H(e,d,_),O(d,a,_),H(n,d,_),O(d,s,_),f&&f.m(d,_),O(d,l,_),o=!0},p(d,_){i=d;const v={};_[0]&1&&(v.value=i[0]),_[0]&4096&&(v.mask_opacity=i[12]),_[0]&32768&&(v.mode=i[15]),_[0]&17825792&&(v.width=i[20]||i[24]),_[0]&8912896&&(v.height=i[19]||i[23]),_[0]&10485760&&(v.container_height=i[21]||i[23]),_[0]&4194304&&(v.value_img=i[22]),_[0]&64&&(v.source=i[6]),_[0]&128&&(v.shape=i[7]),!t&&_[0]&4&&(t=!0,v.brush_radius=i[2],_e(()=>t=!1)),!r&&_[0]&8&&(r=!0,v.brush_color=i[3],_e(()=>r=!1)),e.$set(v);const E={};_[0]&4194304&&(E.show_eraser=i[22]),n.$set(E),i[1]==="color-sketch"||i[1]==="sketch"?f?(f.p(i,_),_[0]&2&&w(f,1)):(f=ji(i),f.c(),w(f,1),f.m(l.parentNode,l)):f&&(ve(),D(f,1,1,()=>{f=null}),we())},i(d){o||(w(e.$$.fragment,d),w(n.$$.fragment,d),w(f),o=!0)},o(d){D(e.$$.fragment,d),D(n.$$.fragment,d),D(f),o=!1},d(d){d&&(T(a),T(s),T(l)),i[38](null),P(e,d),P(n,d),f&&f.d(d)}}}function ji(i){let e,t,r,a;function n(o){i[43](o)}function s(o){i[44](o)}let l={container_height:i[21]||i[23],img_width:i[20]||i[24],img_height:i[19]||i[23],mode:i[15]};return i[2]!==void 0&&(l.brush_radius=i[2]),i[3]!==void 0&&(l.brush_color=i[3]),e=new ri({props:l}),j.push(()=>ge(e,"brush_radius",n)),j.push(()=>ge(e,"brush_color",s)),e.$on("redraw",function(){Ot(i[16].redraw())&&i[16].redraw().apply(this,arguments)}),{c(){B(e.$$.fragment)},m(o,h){H(e,o,h),a=!0},p(o,h){i=o;const u={};h[0]&10485760&&(u.container_height=i[21]||i[23]),h[0]&17825792&&(u.img_width=i[20]||i[24]),h[0]&8912896&&(u.img_height=i[19]||i[23]),h[0]&32768&&(u.mode=i[15]),!t&&h[0]&4&&(t=!0,u.brush_radius=i[2],_e(()=>t=!1)),!r&&h[0]&8&&(r=!0,u.brush_color=i[3],_e(()=>r=!1)),e.$set(u)},i(o){a||(w(e.$$.fragment,o),a=!0)},o(o){D(e.$$.fragment,o),a=!1},d(o){P(e,o)}}}function Ba(i){let e,t,r,a;const n=[La,za,Na,Ia,Sa],s=[];function l(o,h){return o[0]===null&&!o[25]||o[8]?0:o[1]==="select"?1:o[1]==="editor"?2:(o[1]==="sketch"||o[1]==="color-sketch")&&(o[0]!==null||o[25])?3:4}return e=l(i),t=s[e]=n[e](i),{c(){t.c(),r=Pe()},m(o,h){s[e].m(o,h),O(o,r,h),a=!0},p(o,h){let u=e;e=l(o),e===u?s[e].p(o,h):(ve(),D(s[u],1,1,()=>{s[u]=null}),we(),t=s[e],t?t.p(o,h):(t=s[e]=n[e](o),t.c()),w(t,1),t.m(r.parentNode,r))},i(o){a||(w(t),a=!0)},o(o){D(t),a=!1},d(o){o&&T(r),s[e].d(o)}}}function Ha(i){let e,t,r,a,n,s,l;e=new Rr({props:{show_label:i[5],Icon:i[6]==="canvas"?hi:li,label:i[4]||(i[6]==="canvas"?"Sketch":"Image")}});const o=[Aa,Ra,Ca,Ta,Oa,Ma,Da],h=[];function u(c,f){return c[6]==="upload"?0:c[6]==="canvas"?1:c[0]===null&&!c[25]||c[8]?2:c[1]==="select"?3:c[1]==="editor"?4:(c[1]==="sketch"||c[1]==="color-sketch")&&(c[0]!==null||c[25])?5:6}return a=u(i),n=h[a]=o[a](i),{c(){B(e.$$.fragment),t=$(),r=K("div"),n.c(),m(r,"class","image-container svelte-p3y7hu"),m(r,"data-testid","image"),Kt(()=>i[66].call(r))},m(c,f){H(e,c,f),O(c,t,f),O(c,r,f),h[a].m(r,null),s=qi(r,i[66].bind(r)),l=!0},p(c,f){const d={};f[0]&32&&(d.show_label=c[5]),f[0]&64&&(d.Icon=c[6]==="canvas"?hi:li),f[0]&80&&(d.label=c[4]||(c[6]==="canvas"?"Sketch":"Image")),e.$set(d);let _=a;a=u(c),a===_?h[a].p(c,f):(ve(),D(h[_],1,1,()=>{h[_]=null}),we(),n=h[a],n?n.p(c,f):(n=h[a]=o[a](c),n.c()),w(n,1),n.m(r,null))},i(c){l||(w(e.$$.fragment,c),w(n),l=!0)},o(c){D(e.$$.fragment,c),D(n),l=!1},d(c){c&&(T(t),T(r)),P(e,c),h[a].d(),s()}}}function Pa(i,e,t){let{$$slots:r={},$$scope:a}=e,{value:n}=e,{label:s=void 0}=e,{show_label:l}=e,{source:o="upload"}=e,{tool:h="editor"}=e,{shape:u}=e,{streaming:c=!1}=e,{pending:f=!1}=e,{mirror_webcam:d}=e,{brush_radius:_}=e,{brush_color:v="#000000"}=e,{selectable:E=!1}=e,{mask_opacity:N}=e,C,A,ee="",y=!1;n&&(o==="upload"||o==="webcam")&&h==="sketch"&&(n={image:n,mask:null});function g({detail:b}){h==="color-sketch"?t(25,Ee=b):t(0,n=(o==="upload"||o==="webcam")&&h==="sketch"?{image:b,mask:null}:b),t(18,y=!0),localStorage.setItem("resetLines","true"),z("upload",b)}function M({detail:b}){t(0,n=null),t(25,Ee=void 0),z("clear")}async function S({detail:b},Re,qa=!1){U==="mask"?o==="webcam"&&Re?t(0,n={image:b,mask:null}):t(0,n={image:typeof n=="string"?n:n?.image||null,mask:b}):(o==="upload"||o==="webcam")&&h==="sketch"?t(0,n={image:b,mask:null}):(ee===""&&t(17,ee=b),t(0,n=b)),await Be(),z(c?"stream":"edit")}const z=st();let x=!1;function se(b){const Re=b.currentTarget;t(20,J=Re.naturalWidth),t(19,Q=Re.naturalHeight),t(21,oe=Re.getBoundingClientRect().height)}async function le(){C.clear(),await Be(),t(0,n=null),t(25,Ee=void 0),t(17,ee=""),t(18,y=!1)}async function Y(){C.clear_mask(),await Be()}let Q=0,J=0,oe=0,U,ue,ye,k,Ee;Zt(async()=>{h==="color-sketch"&&n&&typeof n=="string"&&(t(25,Ee=n),await Be(),se({currentTarget:ue}))});const Ce=b=>{let Re=Ar(b);Re&&z("select",{index:Re,value:null})};function We(b){j[b?"unshift":"push"](()=>{A=b,t(13,A),t(0,n)})}const Ye=b=>(M(b),t(1,h="editor")),Je=()=>t(1,h="select");function ot(b){j[b?"unshift":"push"](()=>{ue=b,t(22,ue)})}function lt(b){j[b?"unshift":"push"](()=>{C=b,t(16,C)})}function ht(b){_=b,t(2,_)}function ut(b){v=b,t(3,v),t(15,U),t(6,o),t(1,h)}const ct=()=>C.undo(),Xe=()=>C.redraw();function ft(b){_=b,t(2,_)}function dt(b){v=b,t(3,v),t(15,U),t(6,o),t(1,h)}function mt(b){x=b,t(14,x)}const gt=()=>C.undo(),_t=()=>C.redraw();function Te(b){_=b,t(2,_)}function Ne(b){v=b,t(3,v),t(15,U),t(6,o),t(1,h)}function pt(b){_=b,t(2,_)}function xe(b){v=b,t(3,v),t(15,U),t(6,o),t(1,h)}function At(b){j[b?"unshift":"push"](()=>{C=b,t(16,C)})}const bt=b=>h==="color-sketch"?g(b):S(b,!0,"");function St(b){Fi.call(this,i,b)}function It(b){j[b?"unshift":"push"](()=>{A=b,t(13,A),t(0,n)})}const Nt=b=>(M(b),t(1,h="editor")),zt=()=>t(1,h="select");function p(b){j[b?"unshift":"push"](()=>{ue=b,t(22,ue)})}function R(b){j[b?"unshift":"push"](()=>{C=b,t(16,C)})}function L(b){_=b,t(2,_)}function ne(b){v=b,t(3,v),t(15,U),t(6,o),t(1,h)}const q=()=>C.undo(),ce=()=>C.redraw();function Ue(b){_=b,t(2,_)}function je(b){v=b,t(3,v),t(15,U),t(6,o),t(1,h)}function Lt(){ye=this.offsetHeight,k=this.offsetWidth,t(23,ye),t(24,k)}return i.$$set=b=>{"value"in b&&t(0,n=b.value),"label"in b&&t(4,s=b.label),"show_label"in b&&t(5,l=b.show_label),"source"in b&&t(6,o=b.source),"tool"in b&&t(1,h=b.tool),"shape"in b&&t(7,u=b.shape),"streaming"in b&&t(8,c=b.streaming),"pending"in b&&t(9,f=b.pending),"mirror_webcam"in b&&t(10,d=b.mirror_webcam),"brush_radius"in b&&t(2,_=b.brush_radius),"brush_color"in b&&t(3,v=b.brush_color),"selectable"in b&&t(11,E=b.selectable),"mask_opacity"in b&&t(12,N=b.mask_opacity),"$$scope"in b&&t(67,a=b.$$scope)},i.$$.update=()=>{i.$$.dirty[0]&1&&z("change",n),i.$$.dirty[0]&16384&&z("drag",x),i.$$.dirty[0]&66&&(o==="canvas"&&h==="sketch"?t(15,U="bw-sketch"):h==="color-sketch"?t(15,U="color-sketch"):(o==="upload"||o==="webcam")&&h==="sketch"?t(15,U="mask"):t(15,U="editor")),i.$$.dirty[0]&32768&&t(3,v=U=="mask"?"#000000":"#000"),i.$$.dirty[0]&1&&(n===null||n.image===null&&n.mask===null)&&t(25,Ee=void 0),i.$$.dirty[0]&8193&&A&&(n?(t(13,A.image=n,A),A.create()):A.destroy())},[n,h,_,v,s,l,o,u,c,f,d,E,N,A,x,U,C,ee,y,Q,J,oe,ue,ye,k,Ee,g,M,S,se,le,Y,Ce,r,We,Ye,Je,ot,lt,ht,ut,ct,Xe,ft,dt,mt,gt,_t,Te,Ne,pt,xe,At,bt,St,It,Nt,zt,p,R,L,ne,q,ce,Ue,je,Lt,a]}class Wa extends pe{constructor(e){super(),be(this,e,Pa,Ha,he,{value:0,label:4,show_label:5,source:6,tool:1,shape:7,streaming:8,pending:9,mirror_webcam:10,brush_radius:2,brush_color:3,selectable:11,mask_opacity:12},null,[-1,-1,-1])}}function Ya(i){let e,t;return e=new Br({props:{type:"image"}}),{c(){B(e.$$.fragment)},m(r,a){H(e,r,a),t=!0},p:W,i(r){t||(w(e.$$.fragment,r),t=!0)},o(r){D(e.$$.fragment,r),t=!1},d(r){P(e,r)}}}function Xa(i){let e,t,r,a,n;const s=[i[1]];let l={};for(let u=0;u<s.length;u+=1)l=Mr(l,s[u]);e=new Or({props:l});function o(u){i[24](u)}let h={brush_radius:i[15],brush_color:i[16],shape:i[14],source:i[5],tool:i[6],selectable:i[18],mask_opacity:i[17],label:i[7],show_label:i[8],pending:i[10],streaming:i[9],mirror_webcam:i[13],$$slots:{default:[Ya]},$$scope:{ctx:i}};return i[0]!==void 0&&(h.value=i[0]),r=new Wa({props:h}),j.push(()=>ge(r,"value",o)),r.$on("edit",i[25]),r.$on("clear",i[26]),r.$on("stream",i[27]),r.$on("drag",i[28]),r.$on("upload",i[29]),r.$on("select",i[30]),r.$on("share",i[31]),r.$on("error",i[32]),{c(){B(e.$$.fragment),t=$(),B(r.$$.fragment)},m(u,c){H(e,u,c),O(u,t,c),H(r,u,c),n=!0},p(u,c){const f=c[0]&2?Tr(s,[Cr(u[1])]):{};e.$set(f);const d={};c[0]&32768&&(d.brush_radius=u[15]),c[0]&65536&&(d.brush_color=u[16]),c[0]&16384&&(d.shape=u[14]),c[0]&32&&(d.source=u[5]),c[0]&64&&(d.tool=u[6]),c[0]&262144&&(d.selectable=u[18]),c[0]&131072&&(d.mask_opacity=u[17]),c[0]&128&&(d.label=u[7]),c[0]&256&&(d.show_label=u[8]),c[0]&1024&&(d.pending=u[10]),c[0]&512&&(d.streaming=u[9]),c[0]&8192&&(d.mirror_webcam=u[13]),c[1]&4&&(d.$$scope={dirty:c,ctx:u}),!a&&c[0]&1&&(a=!0,d.value=u[0],_e(()=>a=!1)),r.$set(d)},i(u){n||(w(e.$$.fragment,u),w(r.$$.fragment,u),n=!0)},o(u){D(e.$$.fragment,u),D(r.$$.fragment,u),n=!1},d(u){u&&T(t),P(e,u),P(r,u)}}}function Ua(i){let e,t;return e=new Lr({props:{visible:i[4],variant:i[0]===null&&i[5]==="upload"?"dashed":"solid",border_mode:i[23]?"focus":"base",padding:!1,elem_id:i[2],elem_classes:i[3],height:i[11]||(i[5]==="webcam"?void 0:Vi),width:i[12],allow_overflow:!1,container:i[19],scale:i[20],min_width:i[21],$$slots:{default:[Xa]},$$scope:{ctx:i}}}),{c(){B(e.$$.fragment)},m(r,a){H(e,r,a),t=!0},p(r,a){const n={};a[0]&16&&(n.visible=r[4]),a[0]&33&&(n.variant=r[0]===null&&r[5]==="upload"?"dashed":"solid"),a[0]&8388608&&(n.border_mode=r[23]?"focus":"base"),a[0]&4&&(n.elem_id=r[2]),a[0]&8&&(n.elem_classes=r[3]),a[0]&2080&&(n.height=r[11]||(r[5]==="webcam"?void 0:Vi)),a[0]&4096&&(n.width=r[12]),a[0]&524288&&(n.container=r[19]),a[0]&1048576&&(n.scale=r[20]),a[0]&2097152&&(n.min_width=r[21]),a[0]&13101027|a[1]&4&&(n.$$scope={dirty:a,ctx:r}),e.$set(n)},i(r){t||(w(e.$$.fragment,r),t=!0)},o(r){D(e.$$.fragment,r),t=!1},d(r){P(e,r)}}}const Vi=240;function ja(i,e,t){let{elem_id:r=""}=e,{elem_classes:a=[]}=e,{visible:n=!0}=e,{value:s=null}=e,{source:l="upload"}=e,{tool:o="editor"}=e,{label:h}=e,{show_label:u}=e,{streaming:c}=e,{pending:f}=e,{height:d}=e,{width:_}=e,{mirror_webcam:v}=e,{shape:E}=e,{brush_radius:N}=e,{brush_color:C}=e,{mask_opacity:A}=e,{selectable:ee=!1}=e,{container:y=!0}=e,{scale:g=null}=e,{min_width:M=void 0}=e,{loading_status:S}=e,{gradio:z}=e,x;function se(k){s=k,t(0,s)}const le=()=>z.dispatch("edit"),Y=()=>z.dispatch("clear"),Q=()=>z.dispatch("stream"),J=({detail:k})=>t(23,x=k),oe=()=>z.dispatch("upload"),U=({detail:k})=>z.dispatch("select",k),ue=({detail:k})=>z.dispatch("share",k),ye=({detail:k})=>{t(1,S=S||{}),t(1,S.status="error",S),z.dispatch("error",k)};return i.$$set=k=>{"elem_id"in k&&t(2,r=k.elem_id),"elem_classes"in k&&t(3,a=k.elem_classes),"visible"in k&&t(4,n=k.visible),"value"in k&&t(0,s=k.value),"source"in k&&t(5,l=k.source),"tool"in k&&t(6,o=k.tool),"label"in k&&t(7,h=k.label),"show_label"in k&&t(8,u=k.show_label),"streaming"in k&&t(9,c=k.streaming),"pending"in k&&t(10,f=k.pending),"height"in k&&t(11,d=k.height),"width"in k&&t(12,_=k.width),"mirror_webcam"in k&&t(13,v=k.mirror_webcam),"shape"in k&&t(14,E=k.shape),"brush_radius"in k&&t(15,N=k.brush_radius),"brush_color"in k&&t(16,C=k.brush_color),"mask_opacity"in k&&t(17,A=k.mask_opacity),"selectable"in k&&t(18,ee=k.selectable),"container"in k&&t(19,y=k.container),"scale"in k&&t(20,g=k.scale),"min_width"in k&&t(21,M=k.min_width),"loading_status"in k&&t(1,S=k.loading_status),"gradio"in k&&t(22,z=k.gradio)},i.$$.update=()=>{i.$$.dirty[0]&1&&t(0,s=s||null),i.$$.dirty[0]&4194305&&z.dispatch("change")},[s,S,r,a,n,l,o,h,u,c,f,d,_,v,E,N,C,A,ee,y,g,M,z,x,se,le,Y,Q,J,oe,U,ue,ye]}class Va extends pe{constructor(e){super(),be(this,e,ja,Ua,he,{elem_id:2,elem_classes:3,visible:4,value:0,source:5,tool:6,label:7,show_label:8,streaming:9,pending:10,height:11,width:12,mirror_webcam:13,shape:14,brush_radius:15,brush_color:16,mask_opacity:17,selectable:18,container:19,scale:20,min_width:21,loading_status:1,gradio:22},null,[-1,-1])}get elem_id(){return this.$$.ctx[2]}set elem_id(e){this.$$set({elem_id:e}),G()}get elem_classes(){return this.$$.ctx[3]}set elem_classes(e){this.$$set({elem_classes:e}),G()}get visible(){return this.$$.ctx[4]}set visible(e){this.$$set({visible:e}),G()}get value(){return this.$$.ctx[0]}set value(e){this.$$set({value:e}),G()}get source(){return this.$$.ctx[5]}set source(e){this.$$set({source:e}),G()}get tool(){return this.$$.ctx[6]}set tool(e){this.$$set({tool:e}),G()}get label(){return this.$$.ctx[7]}set label(e){this.$$set({label:e}),G()}get show_label(){return this.$$.ctx[8]}set show_label(e){this.$$set({show_label:e}),G()}get streaming(){return this.$$.ctx[9]}set streaming(e){this.$$set({streaming:e}),G()}get pending(){return this.$$.ctx[10]}set pending(e){this.$$set({pending:e}),G()}get height(){return this.$$.ctx[11]}set height(e){this.$$set({height:e}),G()}get width(){return this.$$.ctx[12]}set width(e){this.$$set({width:e}),G()}get mirror_webcam(){return this.$$.ctx[13]}set mirror_webcam(e){this.$$set({mirror_webcam:e}),G()}get shape(){return this.$$.ctx[14]}set shape(e){this.$$set({shape:e}),G()}get brush_radius(){return this.$$.ctx[15]}set brush_radius(e){this.$$set({brush_radius:e}),G()}get brush_color(){return this.$$.ctx[16]}set brush_color(e){this.$$set({brush_color:e}),G()}get mask_opacity(){return this.$$.ctx[17]}set mask_opacity(e){this.$$set({mask_opacity:e}),G()}get selectable(){return this.$$.ctx[18]}set selectable(e){this.$$set({selectable:e}),G()}get container(){return this.$$.ctx[19]}set container(e){this.$$set({container:e}),G()}get scale(){return this.$$.ctx[20]}set scale(e){this.$$set({scale:e}),G()}get min_width(){return this.$$.ctx[21]}set min_width(e){this.$$set({min_width:e}),G()}get loading_status(){return this.$$.ctx[1]}set loading_status(e){this.$$set({loading_status:e}),G()}get gradio(){return this.$$.ctx[22]}set gradio(e){this.$$set({gradio:e}),G()}}const as=Va;export{as as I,nn as W};
//# sourceMappingURL=InteractiveImage-46caa695.js.map
